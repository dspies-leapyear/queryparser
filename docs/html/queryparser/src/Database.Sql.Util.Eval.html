<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- Copyright (c) 2017 Uber Technologies, Inc.</span><span>
</span><a name="line-2"></a><span class="hs-comment">--</span><span>
</span><a name="line-3"></a><span class="hs-comment">-- Permission is hereby granted, free of charge, to any person obtaining a copy</span><span>
</span><a name="line-4"></a><span class="hs-comment">-- of this software and associated documentation files (the &quot;Software&quot;), to deal</span><span>
</span><a name="line-5"></a><span class="hs-comment">-- in the Software without restriction, including without limitation the rights</span><span>
</span><a name="line-6"></a><span class="hs-comment">-- to use, copy, modify, merge, publish, distribute, sublicense, and/or sell</span><span>
</span><a name="line-7"></a><span class="hs-comment">-- copies of the Software, and to permit persons to whom the Software is</span><span>
</span><a name="line-8"></a><span class="hs-comment">-- furnished to do so, subject to the following conditions:</span><span>
</span><a name="line-9"></a><span class="hs-comment">--</span><span>
</span><a name="line-10"></a><span class="hs-comment">-- The above copyright notice and this permission notice shall be included in</span><span>
</span><a name="line-11"></a><span class="hs-comment">-- all copies or substantial portions of the Software.</span><span>
</span><a name="line-12"></a><span class="hs-comment">--</span><span>
</span><a name="line-13"></a><span class="hs-comment">-- THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR</span><span>
</span><a name="line-14"></a><span class="hs-comment">-- IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,</span><span>
</span><a name="line-15"></a><span class="hs-comment">-- FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE</span><span>
</span><a name="line-16"></a><span class="hs-comment">-- AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER</span><span>
</span><a name="line-17"></a><span class="hs-comment">-- LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- THE SOFTWARE.</span><span>
</span><a name="line-20"></a><span>
</span><a name="line-21"></a><span class="hs-pragma">{-# LANGUAGE NamedFieldPuns #-}</span><span>
</span><a name="line-22"></a><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><a name="line-23"></a><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><a name="line-24"></a><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><a name="line-25"></a><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><a name="line-26"></a><span class="hs-pragma">{-# LANGUAGE UndecidableInstances #-}</span><span>
</span><a name="line-27"></a><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><a name="line-28"></a><span class="hs-pragma">{-# LANGUAGE KindSignatures #-}</span><span>
</span><a name="line-29"></a><span class="hs-pragma">{-# LANGUAGE DataKinds #-}</span><span>
</span><a name="line-30"></a><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><a name="line-31"></a><span>
</span><a name="line-32"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Sql</span><span class="hs-operator">.</span><span class="hs-identifier">Util</span><span class="hs-operator">.</span><span class="hs-identifier">Eval</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-33"></a><span>
</span><a name="line-34"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Sql.Type.Query.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Sql</span><span class="hs-operator">.</span><span class="hs-identifier">Type</span><span class="hs-operator">.</span><span class="hs-identifier">Query</span></a><span>
</span><a name="line-35"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Sql.Type.Names.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Sql</span><span class="hs-operator">.</span><span class="hs-identifier">Type</span><span class="hs-operator">.</span><span class="hs-identifier">Names</span></a><span>
</span><a name="line-36"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Sql.Type.Scope.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Sql</span><span class="hs-operator">.</span><span class="hs-identifier">Type</span><span class="hs-operator">.</span><span class="hs-identifier">Scope</span></a><span>
</span><a name="line-37"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Sql.Position.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Sql</span><span class="hs-operator">.</span><span class="hs-identifier">Position</span></a><span>
</span><a name="line-38"></a><span>
</span><a name="line-39"></a><span class="hs-keyword">import</span><span> </span><a href="Database.Sql.Util.Scope.html"><span class="hs-identifier">Database</span><span class="hs-operator">.</span><span class="hs-identifier">Sql</span><span class="hs-operator">.</span><span class="hs-identifier">Util</span><span class="hs-operator">.</span><span class="hs-identifier">Scope</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Scope.html#selectionNames"><span class="hs-identifier hs-var">selectionNames</span></a><span class="hs-special">)</span><span>
</span><a name="line-40"></a><span>
</span><a name="line-41"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Text</span><span class="hs-operator">.</span><span class="hs-identifier">Lazy</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">TL</span><span>
</span><a name="line-42"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Foldable</span><span>
</span><a name="line-43"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">List</span><span class="hs-operator">.</span><span class="hs-identifier">NonEmpty</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">NonEmpty</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-44"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">)</span><span>
</span><a name="line-45"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">M</span><span>
</span><a name="line-46"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Except</span><span>
</span><a name="line-47"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Identity</span><span>
</span><a name="line-48"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Reader</span><span>
</span><a name="line-49"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">State</span><span>
</span><a name="line-50"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Control</span><span class="hs-operator">.</span><span class="hs-identifier">Monad</span><span class="hs-operator">.</span><span class="hs-identifier">Writer</span><span>
</span><a name="line-51"></a><span class="hs-keyword">import</span><span>           </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Proxy</span><span>
</span><a name="line-52"></a><span>
</span><a name="line-53"></a><span>
</span><a name="line-54"></a><span class="hs-keyword">data</span><span> </span><a name="RecordSet"><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier">RecordSet</span></a></a><span> </span><a name="local-6989586621679348715"><a href="#local-6989586621679348715"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="RecordSet"><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier">RecordSet</span></a></a><span>
</span><a name="line-55"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="recordSetLabels"><a href="Database.Sql.Util.Eval.html#recordSetLabels"><span class="hs-identifier">recordSetLabels</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Database.Sql.Type.Names.html#RColumnRef"><span class="hs-identifier hs-type">RColumnRef</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><a name="line-56"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="recordSetItems"><a href="Database.Sql.Util.Eval.html#recordSetItems"><span class="hs-identifier">recordSetItems</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348715"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348715"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-57"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-58"></a><span>
</span><a name="line-59"></a><span class="hs-keyword">data</span><span> </span><a name="EvalContext"><a href="Database.Sql.Util.Eval.html#EvalContext"><span class="hs-identifier">EvalContext</span></a></a><span> </span><a name="local-6989586621679348714"><a href="#local-6989586621679348714"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="EvalContext"><a href="Database.Sql.Util.Eval.html#EvalContext"><span class="hs-identifier">EvalContext</span></a></a><span>
</span><a name="line-60"></a><span>    </span><span class="hs-special">{</span><span> </span><a name="evalAliasMap"><a href="Database.Sql.Util.Eval.html#evalAliasMap"><span class="hs-identifier">evalAliasMap</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><a href="Database.Sql.Type.Names.html#TableAliasId"><span class="hs-identifier hs-type">TableAliasId</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348714"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-61"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="evalFromTable"><a href="Database.Sql.Util.Eval.html#evalFromTable"><span class="hs-identifier">evalFromTable</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Type.Scope.html#RTableName"><span class="hs-identifier hs-type">RTableName</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348714"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-62"></a><span>    </span><span class="hs-special">,</span><span> </span><a name="evalRow"><a href="Database.Sql.Util.Eval.html#evalRow"><span class="hs-identifier">evalRow</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Names.html#RColumnRef"><span class="hs-identifier hs-type">RColumnRef</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348714"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-63"></a><span>    </span><span class="hs-special">}</span><span>
</span><a name="line-64"></a><span>
</span><a name="line-65"></a><span class="hs-keyword">data</span><span> </span><a name="ContextType"><a href="Database.Sql.Util.Eval.html#ContextType"><span class="hs-identifier">ContextType</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="ExprContext"><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier">ExprContext</span></a></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="TableContext"><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier">TableContext</span></a></a><span>
</span><a name="line-66"></a><span>
</span><a name="line-67"></a><span>
</span><a name="line-68"></a><span class="hs-identifier">exprToTable</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679349020"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679349020"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679349020"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679349021"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Names.html#RColumnRef"><span class="hs-identifier hs-type">RColumnRef</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679349020"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679349020"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679349020"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679349021"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-69"></a><a name="exprToTable"><a href="Database.Sql.Util.Eval.html#exprToTable"><span class="hs-identifier">exprToTable</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-var">EvalT</span></a><span> </span><a name="local-6989586621679349022"><a href="#local-6989586621679349022"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679349023"><a href="#local-6989586621679349023"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-var">EvalT</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">local</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalContext"><span class="hs-identifier hs-var">EvalContext</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalContext"><span class="hs-identifier hs-var">EvalContext</span></a><span class="hs-special">{</span><a href="#local-6989586621679349024"><span class="hs-identifier hs-var">evalRow</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">union</span><span> </span><a href="#local-6989586621679349026"><span class="hs-identifier hs-var">evalRow</span></a><span> </span><a href="#local-6989586621679349023"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">..</span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679349022"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-70"></a><span>
</span><a name="line-71"></a><span class="hs-identifier">tableToExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679349018"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679349018"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679349018"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679349019"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679349018"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679349018"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679349019"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-72"></a><a name="tableToExpr"><a href="Database.Sql.Util.Eval.html#tableToExpr"><span class="hs-identifier">tableToExpr</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-var">EvalT</span></a><span> </span><a name="local-6989586621679349027"><a href="#local-6989586621679349027"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-var">EvalT</span></a><span> </span><a href="#local-6989586621679349027"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-73"></a><span>
</span><a name="line-74"></a><span class="hs-keyword">newtype</span><span> </span><a name="EvalT"><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier">EvalT</span></a></a><span> </span><a name="local-6989586621679348708"><a href="#local-6989586621679348708"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679348709"><a href="#local-6989586621679348709"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Util.Eval.html#ContextType"><span class="hs-identifier hs-type">ContextType</span></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679348710"><a href="#local-6989586621679348710"><span class="hs-identifier">m</span></a></a><span> </span><a name="local-6989586621679348711"><a href="#local-6989586621679348711"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="EvalT"><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier">EvalT</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ReaderT</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalContext"><span class="hs-identifier hs-type">EvalContext</span></a><span> </span><a href="#local-6989586621679348708"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">ExceptT</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="#local-6989586621679348710"><span class="hs-identifier hs-type">m</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348711"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-75"></a><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Functor</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Applicative</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monad</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadReader</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalContext"><span class="hs-identifier hs-type">EvalContext</span></a><span> </span><a href="#local-6989586621679348708"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadError</span><span> </span><span class="hs-identifier hs-type">String</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadWriter</span><span> </span><a href="#local-6989586621679348712"><span class="hs-identifier hs-type">w</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">MonadState</span><span> </span><a href="#local-6989586621679348713"><span class="hs-identifier hs-type">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-keyword">type</span><span> </span><a name="Eval"><a href="Database.Sql.Util.Eval.html#Eval"><span class="hs-identifier">Eval</span></a></a><span> </span><a name="local-6989586621679348706"><a href="#local-6989586621679348706"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679348707"><a href="#local-6989586621679348707"><span class="hs-identifier">t</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348706"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679348707"><span class="hs-identifier hs-type">t</span></a><span> </span><span class="hs-identifier hs-type">Identity</span><span>
</span><a name="line-78"></a><span>
</span><a name="line-79"></a><span class="hs-identifier">runEval</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679349015"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#Eval"><span class="hs-identifier hs-type">Eval</span></a><span> </span><a href="#local-6989586621679349015"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679349016"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679349017"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Scope.html#RTableName"><span class="hs-identifier hs-type">RTableName</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679349015"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="#local-6989586621679349017"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-80"></a><a name="runEval"><a href="Database.Sql.Util.Eval.html#runEval"><span class="hs-identifier">runEval</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">runIdentity</span><span> </span><span class="hs-operator hs-var">.</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Sql.Util.Eval.html#runEvalT"><span class="hs-identifier hs-var">runEvalT</span></a><span>
</span><a name="line-81"></a><span>
</span><a name="line-82"></a><span class="hs-identifier">runEvalT</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679349011"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679349011"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679349012"><span class="hs-identifier hs-type">t</span></a><span> </span><a href="#local-6989586621679349013"><span class="hs-identifier hs-type">m</span></a><span> </span><a href="#local-6989586621679349014"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Scope.html#RTableName"><span class="hs-identifier hs-type">RTableName</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679349011"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679349013"><span class="hs-identifier hs-type">m</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Either</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><a href="#local-6989586621679349014"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span>
</span><a name="line-83"></a><a name="runEvalT"><a href="Database.Sql.Util.Eval.html#runEvalT"><span class="hs-identifier">runEvalT</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-var">EvalT</span></a><span> </span><a name="local-6989586621679349028"><a href="#local-6989586621679349028"><span class="hs-identifier">e</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679349029"><a href="#local-6989586621679349029"><span class="hs-identifier">evalFromTable</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">runExceptT</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">runReaderT</span><span> </span><a href="#local-6989586621679349028"><span class="hs-identifier hs-var">e</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalContext"><span class="hs-identifier hs-var">EvalContext</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span>
</span><a name="line-84"></a><span>  </span><span class="hs-keyword">where</span><span>
</span><a name="line-85"></a><span>    </span><a name="local-6989586621679349030"><a href="#local-6989586621679349030"><span class="hs-identifier">evalAliasMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-86"></a><span>    </span><a name="local-6989586621679349031"><a href="#local-6989586621679349031"><span class="hs-identifier">evalRow</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">empty</span><span>
</span><a name="line-87"></a><span>
</span><a name="line-88"></a><span class="hs-keyword">class</span><span> </span><a name="Evaluate"><a href="Database.Sql.Util.Eval.html#Evaluate"><span class="hs-identifier">Evaluate</span></a></a><span> </span><a name="local-6989586621679348704"><a href="#local-6989586621679348704"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679348705"><a href="#local-6989586621679348705"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-89"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalResult</span><span> </span><a name="local-6989586621679348704"><a href="#local-6989586621679348704"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679348705"><a href="#local-6989586621679348705"><span class="hs-identifier">q</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator hs-type">*</span><span>
</span><a name="line-90"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679348704"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679348705"><span class="hs-identifier hs-type">q</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalResult"><span class="hs-identifier hs-type">EvalResult</span></a><span> </span><a href="#local-6989586621679348704"><span class="hs-identifier hs-type">e</span></a><span> </span><a href="#local-6989586621679348705"><span class="hs-identifier hs-type">q</span></a><span>
</span><a name="line-91"></a><span>
</span><a name="line-92"></a><span class="hs-identifier">introduceAlias</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679349009"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679349009"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Type.Names.html#TableAlias"><span class="hs-identifier hs-type">TableAlias</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679349009"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679349009"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679349009"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679349010"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679349009"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679349009"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679349010"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-93"></a><a name="introduceAlias"><a href="Database.Sql.Util.Eval.html#introduceAlias"><span class="hs-identifier">introduceAlias</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Names.html#TableAlias"><span class="hs-identifier hs-var">TableAlias</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679349032"><a href="#local-6989586621679349032"><span class="hs-identifier">alias</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679349033"><a href="#local-6989586621679349033"><span class="hs-identifier">tbl</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">local</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalContext"><span class="hs-identifier hs-var">EvalContext</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalContext"><span class="hs-identifier hs-var">EvalContext</span></a><span class="hs-special">{</span><a href="#local-6989586621679349035"><span class="hs-identifier hs-var">evalAliasMap</span></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span><span> </span><a href="#local-6989586621679349032"><span class="hs-identifier hs-var">alias</span></a><span> </span><a href="#local-6989586621679349033"><span class="hs-identifier hs-var">tbl</span></a><span> </span><a href="#local-6989586621679349034"><span class="hs-identifier hs-var">evalAliasMap</span></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">..</span><span class="hs-special">}</span><span>
</span><a name="line-94"></a><span>
</span><a name="line-95"></a><span class="hs-identifier">makeRecordSet</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679349008"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Foldable</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679349008"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679349008"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Sql.Type.Names.html#RColumnRef"><span class="hs-identifier hs-type">RColumnRef</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679349008"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679349008"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679349008"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-96"></a><a name="makeRecordSet"><a href="Database.Sql.Util.Eval.html#makeRecordSet"><span class="hs-identifier">makeRecordSet</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679349037"><a href="#local-6989586621679349037"><span class="hs-identifier">cols</span></a></a><span> </span><a name="local-6989586621679349038"><a href="#local-6989586621679349038"><span class="hs-identifier">rows</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-97"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679349039"><a href="#local-6989586621679349039"><span class="hs-identifier">numColumns</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679349037"><span class="hs-identifier hs-var">cols</span></a><span>
</span><a name="line-98"></a><span>     </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">any</span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="hs-operator hs-var">/=</span><span> </span><a href="#local-6989586621679349039"><span class="hs-identifier hs-var">numColumns</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">length</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679349038"><span class="hs-identifier hs-var">rows</span></a><span>
</span><a name="line-99"></a><span>         </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;wrong number of columns in record when constructing RecordSet&quot;</span><span>
</span><a name="line-100"></a><span>         </span><span class="hs-keyword">else</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span> </span><a href="#local-6989586621679349037"><span class="hs-identifier hs-var">cols</span></a><span> </span><a href="#local-6989586621679349038"><span class="hs-identifier hs-var">rows</span></a><span>
</span><a name="line-101"></a><span>
</span><a name="line-102"></a><span class="hs-identifier">emptyRecordSet</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679349007"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679349007"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679349007"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-103"></a><a name="emptyRecordSet"><a href="Database.Sql.Util.Eval.html#emptyRecordSet"><span class="hs-identifier">emptyRecordSet</span></a></a><span> </span><a name="local-6989586621679349040"><a href="#local-6989586621679349040"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#makeRecordSet"><span class="hs-identifier hs-var">makeRecordSet</span></a><span> </span><a href="#local-6989586621679349040"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><a name="line-104"></a><span>
</span><a name="line-105"></a><span class="hs-keyword">class</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Monad</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Monad</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-type">Traversable</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a name="Evaluation"><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier">Evaluation</span></a></a><span> </span><a name="local-6989586621679348698"><a href="#local-6989586621679348698"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-106"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalValue</span><span> </span><a name="local-6989586621679348698"><a href="#local-6989586621679348698"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator hs-type">*</span><span>
</span><a name="line-107"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalRow</span><span> </span><a name="local-6989586621679348698"><a href="#local-6989586621679348698"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator hs-type">*</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-operator hs-type">*</span><span>
</span><a name="line-108"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalMonad</span><span> </span><a name="local-6989586621679348698"><a href="#local-6989586621679348698"><span class="hs-identifier">e</span></a></a><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-operator hs-type">*</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-operator hs-type">*</span><span>
</span><a name="line-109"></a><span>    </span><span class="hs-identifier">addItems</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-110"></a><span>    </span><span class="hs-identifier">removeItems</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-111"></a><span>    </span><span class="hs-identifier">unionItems</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-112"></a><span>    </span><span class="hs-identifier">intersectItems</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-113"></a><span>    </span><span class="hs-identifier">distinctItems</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-114"></a><span>    </span><span class="hs-identifier">offsetItems</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-115"></a><span>    </span><span class="hs-identifier">limitItems</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Int</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-116"></a><span>    </span><span class="hs-identifier">filterBy</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Type.Query.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-117"></a><span>    </span><span class="hs-identifier">inList</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-118"></a><span>    </span><span class="hs-identifier">inSubquery</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-119"></a><span>    </span><span class="hs-identifier">existsSubquery</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-120"></a><span>    </span><span class="hs-identifier">atTimeZone</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-121"></a><span>    </span><span class="hs-identifier">handleConstant</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Type.Query.html#Constant"><span class="hs-identifier hs-type">Constant</span></a><span> </span><a href="#local-6989586621679348699"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-122"></a><span>    </span><span class="hs-identifier">handleCases</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">,</span><span> </span><a href="Database.Sql.Type.Query.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-123"></a><span>    </span><span class="hs-identifier">handleFunction</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Type.Names.html#FunctionName"><span class="hs-identifier hs-type">FunctionName</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Type.Query.html#Distinct"><span class="hs-identifier hs-type">Distinct</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Sql.Type.Query.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><a href="Database.Sql.Type.Names.html#ParamName"><span class="hs-identifier hs-type">ParamName</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">,</span><span> </span><a href="Database.Sql.Type.Query.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Filter"><span class="hs-identifier hs-type">Filter</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#OverSubExpr"><span class="hs-identifier hs-type">OverSubExpr</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-124"></a><span>    </span><span class="hs-identifier">handleGroups</span><span> </span><span class="hs-glyph">::</span><span>  </span><span class="hs-special">[</span><a href="Database.Sql.Type.Names.html#RColumnRef"><span class="hs-identifier hs-type">RColumnRef</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-125"></a><span>    </span><span class="hs-identifier">handleLike</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Type.Query.html#Operator"><span class="hs-identifier hs-type">Operator</span></a><span> </span><a href="#local-6989586621679348700"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Escape"><span class="hs-identifier hs-type">Escape</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Type.Query.html#Pattern"><span class="hs-identifier hs-type">Pattern</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Type.Query.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-126"></a><span>    </span><span class="hs-identifier">handleOrder</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="Database.Sql.Type.Query.html#Order"><span class="hs-identifier hs-type">Order</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-127"></a><span>    </span><span class="hs-identifier">handleSubquery</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-128"></a><span>    </span><span class="hs-identifier">handleJoin</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Type.Query.html#JoinType"><span class="hs-identifier hs-type">JoinType</span></a><span> </span><a href="#local-6989586621679348701"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Type.Query.html#JoinCondition"><span class="hs-identifier hs-type">JoinCondition</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-129"></a><span>    </span><span class="hs-identifier">handleStructField</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Type.Query.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Type.Names.html#StructFieldName"><span class="hs-identifier hs-type">StructFieldName</span></a><span> </span><a href="#local-6989586621679348702"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-130"></a><span>    </span><span class="hs-identifier">handleTypeCast</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Type.Query.html#CastFailureAction"><span class="hs-identifier hs-type">CastFailureAction</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Type.Query.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Type.Query.html#DataType"><span class="hs-identifier hs-type">DataType</span></a><span> </span><a href="#local-6989586621679348703"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-131"></a><span>    </span><span class="hs-identifier">binop</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TL</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-132"></a><span>    </span><span class="hs-identifier">unop</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">TL</span><span class="hs-operator hs-type">.</span><span class="hs-identifier hs-type">Text</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Maybe</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348698"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-133"></a><span>
</span><a name="line-134"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679348942"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluate"><span class="hs-identifier hs-type">Evaluate</span></a><span> </span><a href="#local-6989586621679348942"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-135"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalResult</span><span> </span><a href="#local-6989586621679348942"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Query"><span class="hs-identifier hs-type">Query</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348942"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348942"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348942"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-136"></a><span>    </span><a name="local-8214565720324123583"><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><a name="local-6989586621679348943"><a href="#local-6989586621679348943"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#QuerySelect"><span class="hs-identifier hs-var">QuerySelect</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348944"><a href="#local-6989586621679348944"><span class="hs-identifier">select</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348943"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348944"><span class="hs-identifier hs-var">select</span></a><span>
</span><a name="line-137"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348945"><a href="#local-6989586621679348945"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#QueryExcept"><span class="hs-identifier hs-var">QueryExcept</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Scope.html#ColumnAliasList"><span class="hs-identifier hs-var">ColumnAliasList</span></a><span> </span><a name="local-6989586621679348946"><a href="#local-6989586621679348946"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679348947"><a href="#local-6989586621679348947"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679348948"><a href="#local-6989586621679348948"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-138"></a><span>        </span><a name="local-6989586621679348949"><a href="#local-6989586621679348949"><span class="hs-identifier">exclude</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">recordSetItems</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348945"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348948"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-139"></a><span>        </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span class="hs-special">{</span><a name="local-6989586621679348951"><a href="#local-6989586621679348951"><span class="hs-identifier">recordSetItems</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679348950"><a href="#local-6989586621679348950"><span class="hs-identifier">unfiltered</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348945"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348947"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-140"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679348952"><a href="#local-6989586621679348952"><span class="hs-identifier">labels</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Names.html#RColumnAlias"><span class="hs-identifier hs-var">RColumnAlias</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">void</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348946"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-141"></a><span>        </span><a href="Database.Sql.Util.Eval.html#makeRecordSet"><span class="hs-identifier hs-var">makeRecordSet</span></a><span> </span><a href="#local-6989586621679348945"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348952"><span class="hs-identifier hs-var">labels</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#removeItems"><span class="hs-identifier hs-var">removeItems</span></a><span> </span><a href="#local-6989586621679348945"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348949"><span class="hs-identifier hs-var">exclude</span></a><span> </span><a href="#local-6989586621679348950"><span class="hs-identifier hs-var">unfiltered</span></a><span>
</span><a name="line-142"></a><span>
</span><a name="line-143"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348953"><a href="#local-6989586621679348953"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#QueryUnion"><span class="hs-identifier hs-var">QueryUnion</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Distinct"><span class="hs-identifier hs-var">Distinct</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Scope.html#ColumnAliasList"><span class="hs-identifier hs-var">ColumnAliasList</span></a><span> </span><a name="local-6989586621679348954"><a href="#local-6989586621679348954"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679348955"><a href="#local-6989586621679348955"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679348956"><a href="#local-6989586621679348956"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-144"></a><span>        </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span class="hs-special">{</span><a name="local-6989586621679348958"><a href="#local-6989586621679348958"><span class="hs-identifier">recordSetItems</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679348957"><a href="#local-6989586621679348957"><span class="hs-identifier">lhsRows</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348953"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348955"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-145"></a><span>        </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span class="hs-special">{</span><span class="hs-identifier">recordSetItems</span><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679348959"><a href="#local-6989586621679348959"><span class="hs-identifier">rhsRows</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348953"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348956"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-146"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679348960"><a href="#local-6989586621679348960"><span class="hs-identifier">labels</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Names.html#RColumnAlias"><span class="hs-identifier hs-var">RColumnAlias</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">void</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348954"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-147"></a><span>        </span><a href="Database.Sql.Util.Eval.html#makeRecordSet"><span class="hs-identifier hs-var">makeRecordSet</span></a><span> </span><a href="#local-6989586621679348953"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348960"><span class="hs-identifier hs-var">labels</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#unionItems"><span class="hs-identifier hs-var">unionItems</span></a><span> </span><a href="#local-6989586621679348953"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348957"><span class="hs-identifier hs-var">lhsRows</span></a><span> </span><a href="#local-6989586621679348959"><span class="hs-identifier hs-var">rhsRows</span></a><span>
</span><a name="line-148"></a><span>
</span><a name="line-149"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348961"><a href="#local-6989586621679348961"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#QueryUnion"><span class="hs-identifier hs-var">QueryUnion</span></a><span> </span><a name="local-6989586621679348962"><a href="#local-6989586621679348962"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Distinct"><span class="hs-identifier hs-var">Distinct</span></a><span> </span><span class="hs-identifier hs-var">True</span><span class="hs-special">)</span><span> </span><a name="local-6989586621679348963"><a href="#local-6989586621679348963"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621679348964"><a href="#local-6989586621679348964"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679348965"><a href="#local-6989586621679348965"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-150"></a><span>        </span><a name="local-6989586621679348966"><a href="#local-6989586621679348966"><span class="hs-identifier">result</span></a></a><span class="hs-glyph">@</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span class="hs-special">{</span><a name="local-6989586621679348967"><a href="#local-6989586621679348967"><span class="hs-identifier">recordSetItems</span></a></a><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348961"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#QueryUnion"><span class="hs-identifier hs-var">QueryUnion</span></a><span> </span><a href="#local-6989586621679348962"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Distinct"><span class="hs-identifier hs-var">Distinct</span></a><span> </span><span class="hs-identifier hs-var">False</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348963"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679348964"><span class="hs-identifier hs-var">lhs</span></a><span> </span><a href="#local-6989586621679348965"><span class="hs-identifier hs-var">rhs</span></a><span class="hs-special">)</span><span>
</span><a name="line-151"></a><span>        </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679348966"><span class="hs-identifier hs-var">result</span></a><span class="hs-special">{</span><span class="hs-identifier">recordSetItems</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#distinctItems"><span class="hs-identifier hs-var">distinctItems</span></a><span> </span><a href="#local-6989586621679348961"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348967"><span class="hs-identifier hs-var">recordSetItems</span></a><span class="hs-special">}</span><span>
</span><a name="line-152"></a><span>
</span><a name="line-153"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348968"><a href="#local-6989586621679348968"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#QueryIntersect"><span class="hs-identifier hs-var">QueryIntersect</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Scope.html#ColumnAliasList"><span class="hs-identifier hs-var">ColumnAliasList</span></a><span> </span><a name="local-6989586621679348969"><a href="#local-6989586621679348969"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679348970"><a href="#local-6989586621679348970"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679348971"><a href="#local-6989586621679348971"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-154"></a><span>        </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span class="hs-special">{</span><a name="local-6989586621679348973"><a href="#local-6989586621679348973"><span class="hs-identifier">recordSetItems</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="local-6989586621679348972"><a href="#local-6989586621679348972"><span class="hs-identifier">litems</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348968"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348970"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-155"></a><span>        </span><a name="local-6989586621679348974"><a href="#local-6989586621679348974"><span class="hs-identifier">ritems</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier">recordSetItems</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348968"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348971"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-156"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679348975"><a href="#local-6989586621679348975"><span class="hs-identifier">labels</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Names.html#RColumnAlias"><span class="hs-identifier hs-var">RColumnAlias</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">void</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348969"><span class="hs-identifier hs-var">cs</span></a><span>
</span><a name="line-157"></a><span>        </span><a href="Database.Sql.Util.Eval.html#makeRecordSet"><span class="hs-identifier hs-var">makeRecordSet</span></a><span> </span><a href="#local-6989586621679348968"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348975"><span class="hs-identifier hs-var">labels</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#intersectItems"><span class="hs-identifier hs-var">intersectItems</span></a><span> </span><a href="#local-6989586621679348968"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348972"><span class="hs-identifier hs-var">litems</span></a><span> </span><a href="#local-6989586621679348974"><span class="hs-identifier hs-var">ritems</span></a><span>
</span><a name="line-158"></a><span>
</span><a name="line-159"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348976"><a href="#local-6989586621679348976"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#QueryWith"><span class="hs-identifier hs-var">QueryWith</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679348977"><a href="#local-6989586621679348977"><span class="hs-identifier">query</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348976"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348977"><span class="hs-identifier hs-var">query</span></a><span>
</span><a name="line-160"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348978"><a href="#local-6989586621679348978"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#QueryWith"><span class="hs-identifier hs-var">QueryWith</span></a><span> </span><a name="local-6989586621679348979"><a href="#local-6989586621679348979"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#CTE"><span class="hs-identifier hs-var">CTE</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span class="hs-glyph">:</span><a name="local-6989586621679348984"><a href="#local-6989586621679348984"><span class="hs-identifier">ctes</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679348985"><a href="#local-6989586621679348985"><span class="hs-identifier">query</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-161"></a><span>        </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348978"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348983"><span class="hs-identifier hs-var">cteQuery</span></a><span>
</span><a name="line-162"></a><span>        </span><a name="local-6989586621679348994"><a href="#local-6989586621679348994"><span class="hs-identifier">columns</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679348986"><span class="hs-identifier hs-var">override</span></a><span> </span><a href="#local-6989586621679348982"><span class="hs-identifier hs-var">cteColumns</span></a><span> </span><a href="#local-6989586621679348992"><span class="hs-identifier hs-var">recordSetLabels</span></a><span>
</span><a name="line-163"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679348995"><a href="#local-6989586621679348995"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#makeRecordSet"><span class="hs-identifier hs-var">makeRecordSet</span></a><span> </span><a href="#local-6989586621679348978"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348994"><span class="hs-identifier hs-var">columns</span></a><span> </span><a href="#local-6989586621679348993"><span class="hs-identifier hs-var">recordSetItems</span></a><span>
</span><a name="line-164"></a><span>        </span><a href="Database.Sql.Util.Eval.html#introduceAlias"><span class="hs-identifier hs-var">introduceAlias</span></a><span> </span><a href="#local-6989586621679348978"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">void</span><span> </span><a href="#local-6989586621679348981"><span class="hs-identifier hs-var">cteAlias</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348995"><span class="hs-identifier hs-var">result</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348978"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Type.Query.html#QueryWith"><span class="hs-identifier hs-var">QueryWith</span></a><span> </span><a href="#local-6989586621679348979"><span class="hs-identifier hs-var">info</span></a><span> </span><a href="#local-6989586621679348984"><span class="hs-identifier hs-var">ctes</span></a><span> </span><a href="#local-6989586621679348985"><span class="hs-identifier hs-var">query</span></a><span>
</span><a name="line-165"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-166"></a><span>        </span><a name="local-6989586621679348986"><a href="#local-6989586621679348986"><span class="hs-identifier">override</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><a name="local-6989586621679348987"><a href="#local-6989586621679348987"><span class="hs-identifier">ys</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679348987"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-167"></a><span>        </span><span class="hs-identifier">override</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679348988"><a href="#local-6989586621679348988"><span class="hs-identifier">alias</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679348989"><a href="#local-6989586621679348989"><span class="hs-identifier">xs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679348990"><a href="#local-6989586621679348990"><span class="hs-identifier">ys</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-168"></a><span>            </span><a name="local-6989586621679348991"><a href="#local-6989586621679348991"><span class="hs-identifier">ys'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="#local-6989586621679348986"><span class="hs-identifier hs-var">override</span></a><span> </span><a href="#local-6989586621679348989"><span class="hs-identifier hs-var">xs</span></a><span> </span><a href="#local-6989586621679348990"><span class="hs-identifier hs-var">ys</span></a><span>
</span><a name="line-169"></a><span>            </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Names.html#RColumnAlias"><span class="hs-identifier hs-var">RColumnAlias</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">void</span><span> </span><a href="#local-6989586621679348988"><span class="hs-identifier hs-var">alias</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">:</span><span> </span><a href="#local-6989586621679348991"><span class="hs-identifier hs-var">ys'</span></a><span>
</span><a name="line-170"></a><span>        </span><span class="hs-identifier">override</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">throwError</span><span> </span><span class="hs-string">&quot;more aliases than columns in CTE&quot;</span><span>
</span><a name="line-171"></a><span>
</span><a name="line-172"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348996"><a href="#local-6989586621679348996"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#QueryLimit"><span class="hs-identifier hs-var">QueryLimit</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348997"><a href="#local-6989586621679348997"><span class="hs-identifier">limit</span></a></a><span> </span><a name="local-6989586621679348998"><a href="#local-6989586621679348998"><span class="hs-identifier">query</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348996"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348997"><span class="hs-identifier hs-var">limit</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348996"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348998"><span class="hs-identifier hs-var">query</span></a><span>
</span><a name="line-173"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348999"><a href="#local-6989586621679348999"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#QueryOffset"><span class="hs-identifier hs-var">QueryOffset</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679349000"><a href="#local-6989586621679349000"><span class="hs-identifier">offset</span></a></a><span> </span><a name="local-6989586621679349001"><a href="#local-6989586621679349001"><span class="hs-identifier">query</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348999"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679349000"><span class="hs-identifier hs-var">offset</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348999"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679349001"><span class="hs-identifier hs-var">query</span></a><span>
</span><a name="line-174"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679349002"><a href="#local-6989586621679349002"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#QueryOrder"><span class="hs-identifier hs-var">QueryOrder</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679349003"><a href="#local-6989586621679349003"><span class="hs-identifier">orders</span></a></a><span> </span><a name="local-6989586621679349004"><a href="#local-6989586621679349004"><span class="hs-identifier">query</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679349002"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679349004"><span class="hs-identifier hs-var">query</span></a><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><a href="Database.Sql.Util.Eval.html#handleOrder"><span class="hs-identifier hs-var">handleOrder</span></a><span> </span><a href="#local-6989586621679349002"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679349003"><span class="hs-identifier hs-var">orders</span></a><span>
</span><a name="line-175"></a><span>
</span><a name="line-176"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679348922"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluate"><span class="hs-identifier hs-type">Evaluate</span></a><span> </span><a href="#local-6989586621679348922"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-177"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalResult</span><span> </span><a href="#local-6989586621679348922"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Select"><span class="hs-identifier hs-type">Select</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348922"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348922"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348922"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-178"></a><span>    </span><a name="local-8214565720324123583"><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><a name="local-6989586621679348923"><a href="#local-6989586621679348923"><span class="hs-identifier">p</span></a></a><span> </span><a href="Database.Sql.Type.Query.html#Select"><span class="hs-identifier hs-var">Select</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-179"></a><span>        </span><span class="hs-comment">-- nb. if we handle named windows at resolution time (T637160)</span><span>
</span><a name="line-180"></a><span>        </span><span class="hs-comment">-- then we shouldn't need to do anything with them here</span><span>
</span><a name="line-181"></a><span>        </span><a name="local-6989586621679348933"><a href="#local-6989586621679348933"><span class="hs-identifier">unfiltered</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#emptyRecordSet"><span class="hs-identifier hs-var">emptyRecordSet</span></a><span> </span><a href="#local-6989586621679348923"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348923"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348926"><span class="hs-identifier hs-var">selectFrom</span></a><span>
</span><a name="line-182"></a><span>        </span><a name="local-6989586621679348934"><a href="#local-6989586621679348934"><span class="hs-identifier">filtered</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348923"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348927"><span class="hs-identifier hs-var">selectWhere</span></a><span> </span><a href="#local-6989586621679348933"><span class="hs-identifier hs-var">unfiltered</span></a><span>
</span><a name="line-183"></a><span>        </span><a name="local-6989586621679348935"><a href="#local-6989586621679348935"><span class="hs-identifier">interpolated</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348923"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348928"><span class="hs-identifier hs-var">selectTimeseries</span></a><span> </span><a href="#local-6989586621679348934"><span class="hs-identifier hs-var">filtered</span></a><span>
</span><a name="line-184"></a><span>        </span><a name="local-6989586621679348936"><a href="#local-6989586621679348936"><span class="hs-identifier">groups</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">const</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">pure</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348923"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348929"><span class="hs-identifier hs-var">selectGroup</span></a><span> </span><a href="#local-6989586621679348925"><span class="hs-identifier hs-var">selectCols</span></a><span> </span><a href="#local-6989586621679348935"><span class="hs-identifier hs-var">interpolated</span></a><span>
</span><a name="line-185"></a><span>        </span><a name="local-6989586621679348937"><a href="#local-6989586621679348937"><span class="hs-identifier">having</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">maybe</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348923"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348930"><span class="hs-identifier hs-var">selectHaving</span></a><span> </span><a href="#local-6989586621679348936"><span class="hs-identifier hs-var">groups</span></a><span>
</span><a name="line-186"></a><span>        </span><a name="local-6989586621679348938"><a href="#local-6989586621679348938"><span class="hs-identifier">records</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348923"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348925"><span class="hs-identifier hs-var">selectCols</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348937"><span class="hs-identifier hs-var">having</span></a><span>
</span><a name="line-187"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679348939"><a href="#local-6989586621679348939"><span class="hs-identifier">rows</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier">recordSetItems</span><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="#local-6989586621679348938"><span class="hs-identifier hs-var">records</span></a><span>
</span><a name="line-188"></a><span>            </span><a name="local-6989586621679348940"><a href="#local-6989586621679348940"><span class="hs-identifier">labels</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">void</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Sql.Type.Names.html#RColumnAlias"><span class="hs-identifier hs-var">RColumnAlias</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Scope.html#selectionNames"><span class="hs-identifier hs-var">selectionNames</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><span class="hs-identifier">selectColumnsList</span><span> </span><a href="#local-6989586621679348925"><span class="hs-identifier hs-var">selectCols</span></a><span>
</span><a name="line-189"></a><span>            </span><a name="local-6989586621679348941"><a href="#local-6989586621679348941"><span class="hs-identifier">indistinct</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#makeRecordSet"><span class="hs-identifier hs-var">makeRecordSet</span></a><span> </span><a href="#local-6989586621679348923"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348940"><span class="hs-identifier hs-var">labels</span></a><span> </span><a href="#local-6989586621679348939"><span class="hs-identifier hs-var">rows</span></a><span>
</span><a name="line-190"></a><span>
</span><a name="line-191"></a><span>        </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679348932"><span class="hs-identifier hs-var">selectDistinct</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-192"></a><span>             </span><a href="Database.Sql.Type.Query.html#Distinct"><span class="hs-identifier hs-var">Distinct</span></a><span> </span><span class="hs-identifier hs-var">True</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679348941"><span class="hs-identifier hs-var">indistinct</span></a><span> </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recordSetItems</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#distinctItems"><span class="hs-identifier hs-var">distinctItems</span></a><span> </span><a href="#local-6989586621679348923"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">recordSetItems</span><span> </span><a href="#local-6989586621679348941"><span class="hs-identifier hs-var">indistinct</span></a><span> </span><span class="hs-special">}</span><span>
</span><a name="line-193"></a><span>             </span><a href="Database.Sql.Type.Query.html#Distinct"><span class="hs-identifier hs-var">Distinct</span></a><span> </span><span class="hs-identifier hs-var">False</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679348941"><span class="hs-identifier hs-var">indistinct</span></a><span>
</span><a name="line-194"></a><span>
</span><a name="line-195"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679348912"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluate"><span class="hs-identifier hs-type">Evaluate</span></a><span> </span><a href="#local-6989586621679348912"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectFrom"><span class="hs-identifier hs-type">SelectFrom</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-196"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalResult</span><span> </span><a href="#local-6989586621679348912"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectFrom"><span class="hs-identifier hs-type">SelectFrom</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348912"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348912"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348912"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-197"></a><span>    </span><a name="local-8214565720324123583"><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><a name="local-6989586621679348913"><a href="#local-6989586621679348913"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectFrom"><span class="hs-identifier hs-var">SelectFrom</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#emptyRecordSet"><span class="hs-identifier hs-var">emptyRecordSet</span></a><span> </span><a href="#local-6989586621679348913"><span class="hs-identifier hs-var">p</span></a><span>
</span><a name="line-198"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348914"><a href="#local-6989586621679348914"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectFrom"><span class="hs-identifier hs-var">SelectFrom</span></a><span> </span><a name="local-6989586621679348915"><a href="#local-6989586621679348915"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679348916"><a href="#local-6989586621679348916"><span class="hs-identifier">t</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679348917"><a href="#local-6989586621679348917"><span class="hs-identifier">ts</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-199"></a><span>        </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span> </span><a name="local-6989586621679348918"><a href="#local-6989586621679348918"><span class="hs-identifier">rcols</span></a></a><span> </span><a name="local-6989586621679348919"><a href="#local-6989586621679348919"><span class="hs-identifier">rrows</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348914"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Type.Query.html#SelectFrom"><span class="hs-identifier hs-var">SelectFrom</span></a><span> </span><a href="#local-6989586621679348915"><span class="hs-identifier hs-var">info</span></a><span> </span><a href="#local-6989586621679348917"><span class="hs-identifier hs-var">ts</span></a><span>
</span><a name="line-200"></a><span>        </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span> </span><a name="local-6989586621679348920"><a href="#local-6989586621679348920"><span class="hs-identifier">lcols</span></a></a><span> </span><a name="local-6989586621679348921"><a href="#local-6989586621679348921"><span class="hs-identifier">lrows</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348914"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348916"><span class="hs-identifier hs-var">t</span></a><span>
</span><a name="line-201"></a><span>        </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#makeRecordSet"><span class="hs-identifier hs-var">makeRecordSet</span></a><span> </span><a href="#local-6989586621679348914"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679348920"><span class="hs-identifier hs-var">lcols</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679348918"><span class="hs-identifier hs-var">rcols</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679348921"><span class="hs-identifier hs-var">lrows</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679348919"><span class="hs-identifier hs-var">rrows</span></a><span>
</span><a name="line-202"></a><span>
</span><a name="line-203"></a><span>
</span><a name="line-204"></a><span class="hs-identifier">appendRecordSets</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679349006"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Proxy</span><span> </span><a href="#local-6989586621679349006"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">NonEmpty</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679349006"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679349006"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679349006"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679349006"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-205"></a><a name="appendRecordSets"><a href="Database.Sql.Util.Eval.html#appendRecordSets"><span class="hs-identifier">appendRecordSets</span></a></a><span> </span><a name="local-6989586621679349041"><a href="#local-6989586621679349041"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span> </span><a name="local-6989586621679349042"><a href="#local-6989586621679349042"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621679349043"><a href="#local-6989586621679349043"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-operator hs-var">:|</span><span> </span><a name="local-6989586621679349044"><a href="#local-6989586621679349044"><span class="hs-identifier">sets</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#makeRecordSet"><span class="hs-identifier hs-var">makeRecordSet</span></a><span> </span><a href="#local-6989586621679349041"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679349042"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">foldM</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#addItems"><span class="hs-identifier hs-var">addItems</span></a><span> </span><a href="#local-6989586621679349041"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679349043"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">recordSetItems</span><span> </span><a href="#local-6989586621679349044"><span class="hs-identifier hs-var">sets</span></a><span class="hs-special">)</span><span>
</span><a name="line-206"></a><span>
</span><a name="line-207"></a><span>
</span><a name="line-208"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679348891"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluate"><span class="hs-identifier hs-type">Evaluate</span></a><span> </span><a href="#local-6989586621679348891"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Tablish"><span class="hs-identifier hs-type">Tablish</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-209"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalResult</span><span> </span><a href="#local-6989586621679348891"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Tablish"><span class="hs-identifier hs-type">Tablish</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348891"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348891"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348891"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-210"></a><span>    </span><a name="local-8214565720324123583"><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#TablishTable"><span class="hs-identifier hs-var">TablishTable</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#RTablishAliases"><span class="hs-identifier hs-var">RTablishAliases</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348892"><a href="#local-6989586621679348892"><span class="hs-identifier">columnAliases</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679348893"><a href="#local-6989586621679348893"><span class="hs-identifier">ref</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-211"></a><span>        </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348900"><a href="#local-6989586621679348900"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><a href="#local-6989586621679348893"><span class="hs-identifier hs-var">ref</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-212"></a><span>            </span><a href="Database.Sql.Type.Scope.html#RTableRef"><span class="hs-identifier hs-var">RTableRef</span></a><span> </span><a name="local-6989586621679348894"><a href="#local-6989586621679348894"><span class="hs-identifier">tableName</span></a></a><span> </span><a name="local-6989586621679348895"><a href="#local-6989586621679348895"><span class="hs-identifier">table</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">asks</span><span> </span><span class="hs-identifier">evalFromTable</span><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Scope.html#RTableName"><span class="hs-identifier hs-var">RTableName</span></a><span> </span><a href="#local-6989586621679348894"><span class="hs-identifier hs-var">tableName</span></a><span> </span><a href="#local-6989586621679348895"><span class="hs-identifier hs-var">table</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span class="hs-keyword">case</span><span>
</span><a name="line-213"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">throwError</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;missing table: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">void</span><span> </span><a href="#local-6989586621679348894"><span class="hs-identifier hs-var">tableName</span></a><span class="hs-special">)</span><span>
</span><a name="line-214"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679348896"><a href="#local-6989586621679348896"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679348896"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-215"></a><span>            </span><a href="Database.Sql.Type.Scope.html#RTableAlias"><span class="hs-identifier hs-var">RTableAlias</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Names.html#TableAlias"><span class="hs-identifier hs-var">TableAlias</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348897"><a href="#local-6989586621679348897"><span class="hs-identifier">aliasName</span></a></a><span> </span><a name="local-6989586621679348898"><a href="#local-6989586621679348898"><span class="hs-identifier">alias</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">asks</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-6989586621679348898"><span class="hs-identifier hs-var">alias</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier">evalAliasMap</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&gt;&gt;=</span><span> </span><span class="hs-glyph">\</span><span class="hs-keyword">case</span><span>
</span><a name="line-216"></a><span>                </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">throwError</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;missing table alias: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679348897"><span class="hs-identifier hs-var">aliasName</span></a><span>
</span><a name="line-217"></a><span>                </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679348899"><a href="#local-6989586621679348899"><span class="hs-identifier">result</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679348899"><span class="hs-identifier hs-var">result</span></a><span>
</span><a name="line-218"></a><span>        </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Names.html#RColumnAlias"><span class="hs-identifier hs-var">RColumnAlias</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">void</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348892"><span class="hs-identifier hs-var">columnAliases</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348900"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-219"></a><span>
</span><a name="line-220"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348901"><a href="#local-6989586621679348901"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#TablishSubQuery"><span class="hs-identifier hs-var">TablishSubQuery</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348902"><a href="#local-6989586621679348902"><span class="hs-identifier">query</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348901"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348902"><span class="hs-identifier hs-var">query</span></a><span>
</span><a name="line-221"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348903"><a href="#local-6989586621679348903"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#TablishJoin"><span class="hs-identifier hs-var">TablishJoin</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#RTablishAliases"><span class="hs-identifier hs-var">RTablishAliases</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348904"><a href="#local-6989586621679348904"><span class="hs-identifier">aliases</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679348905"><a href="#local-6989586621679348905"><span class="hs-identifier">joinType</span></a></a><span> </span><a name="local-6989586621679348906"><a href="#local-6989586621679348906"><span class="hs-identifier">cond</span></a></a><span> </span><a name="local-6989586621679348907"><a href="#local-6989586621679348907"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679348908"><a href="#local-6989586621679348908"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-222"></a><span>        </span><a name="local-6989586621679348909"><a href="#local-6989586621679348909"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348903"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348907"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-223"></a><span>        </span><a name="local-6989586621679348910"><a href="#local-6989586621679348910"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348903"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348908"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-224"></a><span>        </span><a name="local-6989586621679348911"><a href="#local-6989586621679348911"><span class="hs-identifier">rs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#handleJoin"><span class="hs-identifier hs-var">handleJoin</span></a><span> </span><a href="#local-6989586621679348903"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348905"><span class="hs-identifier hs-var">joinType</span></a><span> </span><a href="#local-6989586621679348906"><span class="hs-identifier hs-var">cond</span></a><span> </span><a href="#local-6989586621679348909"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679348910"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-225"></a><span>        </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#makeRecordSet"><span class="hs-identifier hs-var">makeRecordSet</span></a><span> </span><a href="#local-6989586621679348903"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Names.html#RColumnAlias"><span class="hs-identifier hs-var">RColumnAlias</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">void</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348904"><span class="hs-identifier hs-var">aliases</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">recordSetItems</span><span> </span><a href="#local-6989586621679348911"><span class="hs-identifier hs-var">rs</span></a><span>
</span><a name="line-226"></a><span>
</span><a name="line-227"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><span class="hs-identifier">_</span><span> </span><a href="Database.Sql.Type.Query.html#TablishLateralView"><span class="hs-identifier hs-var">TablishLateralView</span></a><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;lateral view not yet supported&quot;</span><span>
</span><a name="line-228"></a><span>
</span><a name="line-229"></a><span>
</span><a name="line-230"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679348850"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluate"><span class="hs-identifier hs-type">Evaluate</span></a><span> </span><a href="#local-6989586621679348850"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#JoinCondition"><span class="hs-identifier hs-type">JoinCondition</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-231"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalResult</span><span> </span><a href="#local-6989586621679348850"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#JoinCondition"><span class="hs-identifier hs-type">JoinCondition</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348850"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348850"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348850"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348850"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348850"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-232"></a><span>    </span><a name="local-8214565720324123583"><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><a name="local-6989586621679348851"><a href="#local-6989586621679348851"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#JoinOn"><span class="hs-identifier hs-var">JoinOn</span></a><span> </span><a name="local-6989586621679348852"><a href="#local-6989586621679348852"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span> </span><a name="local-6989586621679348853"><a href="#local-6989586621679348853"><span class="hs-identifier">lcols</span></a></a><span> </span><a name="local-6989586621679348854"><a href="#local-6989586621679348854"><span class="hs-identifier">lrows</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span> </span><a name="local-6989586621679348855"><a href="#local-6989586621679348855"><span class="hs-identifier">rcols</span></a></a><span> </span><a name="local-6989586621679348856"><a href="#local-6989586621679348856"><span class="hs-identifier">rrows</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-233"></a><span>        </span><a href="Database.Sql.Util.Eval.html#filterBy"><span class="hs-identifier hs-var">filterBy</span></a><span> </span><a href="#local-6989586621679348852"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#makeRecordSet"><span class="hs-identifier hs-var">makeRecordSet</span></a><span> </span><a href="#local-6989586621679348851"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679348853"><span class="hs-identifier hs-var">lcols</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679348855"><span class="hs-identifier hs-var">rcols</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679348854"><span class="hs-identifier hs-var">lrows</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679348856"><span class="hs-identifier hs-var">rrows</span></a><span>
</span><a name="line-234"></a><span>
</span><a name="line-235"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348857"><a href="#local-6989586621679348857"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#JoinUsing"><span class="hs-identifier hs-var">JoinUsing</span></a><span> </span><a name="local-6989586621679348858"><a href="#local-6989586621679348858"><span class="hs-identifier">info</span></a></a><span> </span><a name="local-6989586621679348859"><a href="#local-6989586621679348859"><span class="hs-identifier">columns</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span> </span><a name="local-6989586621679348884"><a href="#local-6989586621679348884"><span class="hs-identifier">lcols</span></a></a><span> </span><a name="local-6989586621679348885"><a href="#local-6989586621679348885"><span class="hs-identifier">lrows</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span> </span><a name="local-6989586621679348886"><a href="#local-6989586621679348886"><span class="hs-identifier">rcols</span></a></a><span> </span><a name="local-6989586621679348887"><a href="#local-6989586621679348887"><span class="hs-identifier">rrows</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-236"></a><span>        </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679348861"><span class="hs-identifier hs-var">adjust</span></a><span> </span><a href="#local-6989586621679348859"><span class="hs-identifier hs-var">columns</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#filterBy"><span class="hs-identifier hs-var">filterBy</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679348860"><span class="hs-identifier hs-var">mkExpr</span></a><span> </span><a href="#local-6989586621679348859"><span class="hs-identifier hs-var">columns</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#makeRecordSet"><span class="hs-identifier hs-var">makeRecordSet</span></a><span> </span><a href="#local-6989586621679348857"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="#local-6989586621679348884"><span class="hs-identifier hs-var">lcols</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679348886"><span class="hs-identifier hs-var">rcols</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">++</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="#local-6989586621679348885"><span class="hs-identifier hs-var">lrows</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="#local-6989586621679348887"><span class="hs-identifier hs-var">rrows</span></a><span>
</span><a name="line-237"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-238"></a><span>        </span><span class="hs-identifier">mkExpr</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Database.Sql.Type.Names.html#RUsingColumn"><span class="hs-identifier hs-type">RUsingColumn</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Type.Query.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span>
</span><a name="line-239"></a><span>        </span><a name="local-6989586621679348860"><a href="#local-6989586621679348860"><span class="hs-identifier">mkExpr</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Type.Query.html#ConstantExpr"><span class="hs-identifier hs-var">ConstantExpr</span></a><span> </span><a href="#local-6989586621679348858"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Type.Query.html#BooleanConstant"><span class="hs-identifier hs-var">BooleanConstant</span></a><span> </span><a href="#local-6989586621679348858"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-identifier hs-var">True</span><span>
</span><a name="line-240"></a><span>        </span><span class="hs-identifier">mkExpr</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Names.html#RUsingColumn"><span class="hs-identifier hs-var">RUsingColumn</span></a><span> </span><a name="local-6989586621679348866"><a href="#local-6989586621679348866"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679348867"><a href="#local-6989586621679348867"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">:</span><span> </span><a name="local-6989586621679348868"><a href="#local-6989586621679348868"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-241"></a><span>            </span><a href="Database.Sql.Type.Query.html#BinOpExpr"><span class="hs-identifier hs-var">BinOpExpr</span></a><span> </span><a href="#local-6989586621679348858"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-string">&quot;AND&quot;</span><span>
</span><a name="line-242"></a><span>                </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#BinOpExpr"><span class="hs-identifier hs-var">BinOpExpr</span></a><span> </span><a href="#local-6989586621679348858"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;=&quot;</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#ColumnExpr"><span class="hs-identifier hs-var">ColumnExpr</span></a><span> </span><a href="#local-6989586621679348858"><span class="hs-identifier hs-var">info</span></a><span> </span><a href="#local-6989586621679348866"><span class="hs-identifier hs-var">l</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#ColumnExpr"><span class="hs-identifier hs-var">ColumnExpr</span></a><span> </span><a href="#local-6989586621679348858"><span class="hs-identifier hs-var">info</span></a><span> </span><a href="#local-6989586621679348867"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-243"></a><span>                </span><span class="hs-special">(</span><a href="#local-6989586621679348860"><span class="hs-identifier hs-var">mkExpr</span></a><span> </span><a href="#local-6989586621679348868"><span class="hs-identifier hs-var">cs</span></a><span class="hs-special">)</span><span>
</span><a name="line-244"></a><span>
</span><a name="line-245"></a><span>        </span><span class="hs-identifier">adjust</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Database.Sql.Type.Names.html#RUsingColumn"><span class="hs-identifier hs-type">RUsingColumn</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348850"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348850"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-246"></a><span>        </span><a name="local-6989586621679348861"><a href="#local-6989586621679348861"><span class="hs-identifier">adjust</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">id</span><span>
</span><a name="line-247"></a><span>        </span><span class="hs-identifier">adjust</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679348869"><a href="#local-6989586621679348869"><span class="hs-identifier">c</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679348870"><a href="#local-6989586621679348870"><span class="hs-identifier">cs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679348861"><span class="hs-identifier hs-var">adjust</span></a><span> </span><a href="#local-6989586621679348870"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679348862"><span class="hs-identifier hs-var">adjust'</span></a><span> </span><a href="#local-6989586621679348869"><span class="hs-identifier hs-var">c</span></a><span>
</span><a name="line-248"></a><span>        </span><a name="local-6989586621679348862"><a href="#local-6989586621679348862"><span class="hs-identifier">adjust'</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Names.html#RUsingColumn"><span class="hs-identifier hs-var">RUsingColumn</span></a><span> </span><a name="local-6989586621679348871"><a href="#local-6989586621679348871"><span class="hs-identifier">l</span></a></a><span> </span><a name="local-6989586621679348872"><a href="#local-6989586621679348872"><span class="hs-identifier">r</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-249"></a><span>            </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span>
</span><a name="line-250"></a><span>                </span><span class="hs-special">{</span><span> </span><span class="hs-identifier">recordSetLabels</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">fst</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679348865"><span class="hs-identifier hs-var">remove</span></a><span> </span><a href="#local-6989586621679348872"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679348864"><span class="hs-identifier hs-var">skip</span></a><span> </span><a href="#local-6989586621679348871"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679348873"><span class="hs-identifier hs-var">recordSetLabels</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">repeat</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><a name="line-251"></a><span>                </span><span class="hs-special">,</span><span> </span><span class="hs-identifier">recordSetItems</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">fmap</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier hs-var">snd</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679348865"><span class="hs-identifier hs-var">remove</span></a><span> </span><a href="#local-6989586621679348872"><span class="hs-identifier hs-var">r</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="#local-6989586621679348864"><span class="hs-identifier hs-var">skip</span></a><span> </span><a href="#local-6989586621679348871"><span class="hs-identifier hs-var">l</span></a><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">zip</span><span> </span><a href="#local-6989586621679348873"><span class="hs-identifier hs-var">recordSetLabels</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348874"><span class="hs-identifier hs-var">recordSetItems</span></a><span>
</span><a name="line-252"></a><span>                </span><span class="hs-special">}</span><span>
</span><a name="line-253"></a><span>
</span><a name="line-254"></a><span>        </span><a name="local-6989586621679348863"><a href="#local-6989586621679348863"><span class="hs-identifier">match</span></a></a><span> </span><a name="local-6989586621679348875"><a href="#local-6989586621679348875"><span class="hs-identifier">column</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679348876"><a href="#local-6989586621679348876"><span class="hs-identifier">label</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679348876"><span class="hs-identifier hs-var">label</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">void</span><span> </span><a href="#local-6989586621679348875"><span class="hs-identifier hs-var">column</span></a><span>
</span><a name="line-255"></a><span>        </span><a name="local-6989586621679348864"><a href="#local-6989586621679348864"><span class="hs-identifier">skip</span></a></a><span> </span><a name="local-6989586621679348877"><a href="#local-6989586621679348877"><span class="hs-identifier">column</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">break</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679348863"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679348877"><span class="hs-identifier hs-var">column</span></a><span>
</span><a name="line-256"></a><span>        </span><a name="local-6989586621679348865"><a href="#local-6989586621679348865"><span class="hs-identifier">remove</span></a></a><span> </span><a name="local-6989586621679348878"><a href="#local-6989586621679348878"><span class="hs-identifier">column</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679348879"><a href="#local-6989586621679348879"><span class="hs-identifier">skipped</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679348880"><a href="#local-6989586621679348880"><span class="hs-identifier">next</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679348881"><a href="#local-6989586621679348881"><span class="hs-identifier">rest</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-257"></a><span>            </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">break</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679348863"><span class="hs-identifier hs-var">match</span></a><span> </span><a href="#local-6989586621679348878"><span class="hs-identifier hs-var">column</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348881"><span class="hs-identifier hs-var">rest</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-258"></a><span>                </span><span class="hs-special">(</span><a name="local-6989586621679348882"><a href="#local-6989586621679348882"><span class="hs-identifier">skipped2</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-glyph">:</span><a name="local-6989586621679348883"><a href="#local-6989586621679348883"><span class="hs-identifier">rest2</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679348879"><span class="hs-identifier hs-var">skipped</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679348880"><span class="hs-identifier hs-var">next</span></a><span class="hs-special">]</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679348882"><span class="hs-identifier hs-var">skipped2</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><a href="#local-6989586621679348883"><span class="hs-identifier hs-var">rest2</span></a><span>
</span><a name="line-259"></a><span>                </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;failed to find rhs using column&quot;</span><span>
</span><a name="line-260"></a><span>        </span><span class="hs-identifier">remove</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">_</span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;failed to find lhs using column&quot;</span><span>
</span><a name="line-261"></a><span>
</span><a name="line-262"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348888"><a href="#local-6989586621679348888"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#JoinNatural"><span class="hs-identifier hs-var">JoinNatural</span></a><span> </span><a name="local-6989586621679348889"><a href="#local-6989586621679348889"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Names.html#RNaturalColumns"><span class="hs-identifier hs-var">RNaturalColumns</span></a><span> </span><a name="local-6989586621679348890"><a href="#local-6989586621679348890"><span class="hs-identifier">columns</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348888"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#JoinUsing"><span class="hs-identifier hs-var">JoinUsing</span></a><span> </span><a href="#local-6989586621679348889"><span class="hs-identifier hs-var">info</span></a><span> </span><a href="#local-6989586621679348890"><span class="hs-identifier hs-var">columns</span></a><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Type.Query.html#JoinCondition"><span class="hs-identifier hs-type">JoinCondition</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span>
</span><a name="line-263"></a><span>
</span><a name="line-264"></a><span class="hs-identifier">makeRowMap</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><a href="Database.Sql.Type.Names.html#RColumnRef"><span class="hs-identifier hs-type">RColumnRef</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679349005"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Names.html#RColumnRef"><span class="hs-identifier hs-type">RColumnRef</span></a><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679349005"><span class="hs-identifier hs-type">a</span></a><span>
</span><a name="line-265"></a><a name="makeRowMap"><a href="Database.Sql.Util.Eval.html#makeRowMap"><span class="hs-identifier">makeRowMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-operator hs-var">.</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><span class="hs-identifier hs-var">zip</span><span>
</span><a name="line-266"></a><span>
</span><a name="line-267"></a><span>
</span><a name="line-268"></a><span class="hs-comment">-- | SelectColumns tells us how to map from the records provided by the</span><span>
</span><a name="line-269"></a><span class="hs-comment">-- FROM to (unfiltered, &amp;c) records provided by our select.  Evaluating it</span><span>
</span><a name="line-270"></a><span class="hs-comment">-- gives us that function.</span><span>
</span><a name="line-271"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679348840"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluate"><span class="hs-identifier hs-type">Evaluate</span></a><span> </span><a href="#local-6989586621679348840"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectColumns"><span class="hs-identifier hs-type">SelectColumns</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-272"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalResult</span><span> </span><a href="#local-6989586621679348840"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectColumns"><span class="hs-identifier hs-type">SelectColumns</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348840"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348840"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348840"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348840"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-273"></a><span>    </span><a name="local-8214565720324123583"><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><a name="local-6989586621679348841"><a href="#local-6989586621679348841"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectColumns"><span class="hs-identifier hs-var">SelectColumns</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348842"><a href="#local-6989586621679348842"><span class="hs-identifier">columns</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span> </span><a name="local-6989586621679348843"><a href="#local-6989586621679348843"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621679348844"><a href="#local-6989586621679348844"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-274"></a><span>        </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679348845"><a href="#local-6989586621679348845"><span class="hs-identifier">cs'</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">void</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Sql.Type.Names.html#RColumnAlias"><span class="hs-identifier hs-var">RColumnAlias</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Scope.html#selectionNames"><span class="hs-identifier hs-var">selectionNames</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="#local-6989586621679348842"><span class="hs-identifier hs-var">columns</span></a><span>
</span><a name="line-275"></a><span>        </span><a name="local-6989586621679348849"><a href="#local-6989586621679348849"><span class="hs-identifier">rs'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">forM</span><span> </span><a href="#local-6989586621679348844"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679348846"><a href="#local-6989586621679348846"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-276"></a><span>            </span><a name="local-6989586621679348848"><a href="#local-6989586621679348848"><span class="hs-identifier">r'</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">forM</span><span> </span><a href="#local-6989586621679348842"><span class="hs-identifier hs-var">columns</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679348847"><a href="#local-6989586621679348847"><span class="hs-identifier">column</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-277"></a><span>                </span><a href="Database.Sql.Util.Eval.html#exprToTable"><span class="hs-identifier hs-var">exprToTable</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348841"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348847"><span class="hs-identifier hs-var">column</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#makeRowMap"><span class="hs-identifier hs-var">makeRowMap</span></a><span> </span><a href="#local-6989586621679348843"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679348846"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-278"></a><span>            </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">concat</span><span> </span><a href="#local-6989586621679348848"><span class="hs-identifier hs-var">r'</span></a><span>
</span><a name="line-279"></a><span>        </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#makeRecordSet"><span class="hs-identifier hs-var">makeRecordSet</span></a><span> </span><a href="#local-6989586621679348841"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348845"><span class="hs-identifier hs-var">cs'</span></a><span> </span><a href="#local-6989586621679348849"><span class="hs-identifier hs-var">rs'</span></a><span>
</span><a name="line-280"></a><span>
</span><a name="line-281"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679348838"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluate"><span class="hs-identifier hs-type">Evaluate</span></a><span> </span><a href="#local-6989586621679348838"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectWhere"><span class="hs-identifier hs-type">SelectWhere</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-282"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalResult</span><span> </span><a href="#local-6989586621679348838"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectWhere"><span class="hs-identifier hs-type">SelectWhere</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348838"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348838"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348838"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348838"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-283"></a><span>    </span><a name="local-8214565720324123583"><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectWhere"><span class="hs-identifier hs-var">SelectWhere</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348839"><a href="#local-6989586621679348839"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#filterBy"><span class="hs-identifier hs-var">filterBy</span></a><span> </span><a href="#local-6989586621679348839"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-284"></a><span>
</span><a name="line-285"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679348823"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluate"><span class="hs-identifier hs-type">Evaluate</span></a><span> </span><a href="#local-6989586621679348823"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectGroup"><span class="hs-identifier hs-type">SelectGroup</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-286"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalResult</span><span> </span><a href="#local-6989586621679348823"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectGroup"><span class="hs-identifier hs-type">SelectGroup</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Type.Query.html#SelectColumns"><span class="hs-identifier hs-type">SelectColumns</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348823"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348823"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348823"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348823"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348823"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-287"></a><span>    </span><a name="local-8214565720324123583"><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectGroup"><span class="hs-identifier hs-var">SelectGroup</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348824"><a href="#local-6989586621679348824"><span class="hs-identifier">elts</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679348825"><a href="#local-6989586621679348825"><span class="hs-identifier">columns</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span> </span><a name="local-6989586621679348826"><a href="#local-6989586621679348826"><span class="hs-identifier">cs</span></a></a><span> </span><a name="local-6989586621679348827"><a href="#local-6989586621679348827"><span class="hs-identifier">rs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-288"></a><span>        </span><a name="local-6989586621679348837"><a href="#local-6989586621679348837"><span class="hs-identifier">gs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">forM</span><span> </span><a href="#local-6989586621679348827"><span class="hs-identifier hs-var">rs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><a name="local-6989586621679348832"><a href="#local-6989586621679348832"><span class="hs-identifier">r</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-289"></a><span>            </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><span class="hs-identifier hs-var">Proxy</span><span> </span><a href="#local-6989586621679348825"><span class="hs-identifier hs-var">columns</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span> </span><a href="#local-6989586621679348826"><span class="hs-identifier hs-var">cs</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679348832"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-290"></a><span>            </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679348835"><a href="#local-6989586621679348835"><span class="hs-identifier">selectMap</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#makeRowMap"><span class="hs-identifier hs-var">makeRowMap</span></a><span> </span><a href="#local-6989586621679348833"><span class="hs-identifier hs-var">recordSetLabels</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">toList</span><span> </span><a href="#local-6989586621679348834"><span class="hs-identifier hs-var">recordSetItems</span></a><span class="hs-special">)</span><span>
</span><a name="line-291"></a><span>            </span><a name="local-6989586621679348836"><a href="#local-6989586621679348836"><span class="hs-identifier">g</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#exprToTable"><span class="hs-identifier hs-var">exprToTable</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><span class="hs-identifier hs-var">Proxy</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679348828"><span class="hs-identifier hs-var">eltToExprs</span></a><span> </span><span class="hs-operator hs-var">=&lt;&lt;</span><span> </span><a href="#local-6989586621679348824"><span class="hs-identifier hs-var">elts</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">union</span><span> </span><a href="#local-6989586621679348835"><span class="hs-identifier hs-var">selectMap</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#makeRowMap"><span class="hs-identifier hs-var">makeRowMap</span></a><span> </span><a href="#local-6989586621679348826"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679348832"><span class="hs-identifier hs-var">r</span></a><span>
</span><a name="line-292"></a><span>            </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679348836"><span class="hs-identifier hs-var">g</span></a><span class="hs-special">,</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679348832"><span class="hs-identifier hs-var">r</span></a><span class="hs-special">)</span><span>
</span><a name="line-293"></a><span>        </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#handleGroups"><span class="hs-identifier hs-var">handleGroups</span></a><span> </span><a href="#local-6989586621679348826"><span class="hs-identifier hs-var">cs</span></a><span> </span><a href="#local-6989586621679348837"><span class="hs-identifier hs-var">gs</span></a><span>
</span><a name="line-294"></a><span>      </span><span class="hs-keyword">where</span><span>
</span><a name="line-295"></a><span>        </span><a name="local-6989586621679348828"><a href="#local-6989586621679348828"><span class="hs-identifier">eltToExprs</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#GroupingElementSet"><span class="hs-identifier hs-var">GroupingElementSet</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348829"><a href="#local-6989586621679348829"><span class="hs-identifier">exprs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679348829"><span class="hs-identifier hs-var">exprs</span></a><span>
</span><a name="line-296"></a><span>        </span><span class="hs-identifier">eltToExprs</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#GroupingElementExpr"><span class="hs-identifier hs-var">GroupingElementExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#PositionOrExprExpr"><span class="hs-identifier hs-var">PositionOrExprExpr</span></a><span> </span><a name="local-6989586621679348830"><a href="#local-6989586621679348830"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679348830"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">]</span><span>
</span><a name="line-297"></a><span>        </span><span class="hs-identifier">eltToExprs</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#GroupingElementExpr"><span class="hs-identifier hs-var">GroupingElementExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#PositionOrExprPosition"><span class="hs-identifier hs-var">PositionOrExprPosition</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348831"><a href="#local-6989586621679348831"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><a href="#local-6989586621679348831"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">]</span><span>
</span><a name="line-298"></a><span>
</span><a name="line-299"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679348821"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluate"><span class="hs-identifier hs-type">Evaluate</span></a><span> </span><a href="#local-6989586621679348821"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectHaving"><span class="hs-identifier hs-type">SelectHaving</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-300"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalResult</span><span> </span><a href="#local-6989586621679348821"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectHaving"><span class="hs-identifier hs-type">SelectHaving</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348821"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348821"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348821"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348821"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalRow"><span class="hs-identifier hs-type">EvalRow</span></a><span> </span><a href="#local-6989586621679348821"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348821"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-301"></a><span>    </span><a name="local-8214565720324123583"><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectHaving"><span class="hs-identifier hs-var">SelectHaving</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348822"><a href="#local-6989586621679348822"><span class="hs-identifier">exprs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><span class="hs-special">(</span><span class="hs-operator hs-var">&gt;=&gt;</span><span class="hs-special">)</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Database.Sql.Util.Eval.html#filterBy"><span class="hs-identifier hs-var">filterBy</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348822"><span class="hs-identifier hs-var">exprs</span></a><span>
</span><a name="line-302"></a><span>
</span><a name="line-303"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679348816"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluate"><span class="hs-identifier hs-type">Evaluate</span></a><span> </span><a href="#local-6989586621679348816"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectTimeseries"><span class="hs-identifier hs-type">SelectTimeseries</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-304"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalResult</span><span> </span><a href="#local-6989586621679348816"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectTimeseries"><span class="hs-identifier hs-type">SelectTimeseries</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348816"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348816"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#TableContext"><span class="hs-identifier hs-type">TableContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348816"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348816"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-305"></a><span>    </span><a name="local-8214565720324123583"><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectTimeseries"><span class="hs-identifier hs-var">SelectTimeseries</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348817"><a href="#local-6989586621679348817"><span class="hs-identifier">sliceName</span></a></a><span> </span><a name="local-6989586621679348818"><a href="#local-6989586621679348818"><span class="hs-identifier">interval</span></a></a><span> </span><a name="local-6989586621679348819"><a href="#local-6989586621679348819"><span class="hs-identifier">partition</span></a></a><span> </span><a name="local-6989586621679348820"><a href="#local-6989586621679348820"><span class="hs-identifier">over</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;timeseries not yet supported&quot;</span><span> </span><a href="#local-6989586621679348817"><span class="hs-identifier hs-var">sliceName</span></a><span> </span><a href="#local-6989586621679348818"><span class="hs-identifier hs-var">interval</span></a><span> </span><a href="#local-6989586621679348819"><span class="hs-identifier hs-var">partition</span></a><span> </span><a href="#local-6989586621679348820"><span class="hs-identifier hs-var">over</span></a><span>
</span><a name="line-306"></a><span>
</span><a name="line-307"></a><span class="hs-keyword">data</span><span> </span><a name="Direction"><a href="Database.Sql.Util.Eval.html#Direction"><span class="hs-identifier">Direction</span></a></a><span> </span><a name="local-6989586621679348697"><a href="#local-6989586621679348697"><span class="hs-identifier">a</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a name="Ascending"><a href="Database.Sql.Util.Eval.html#Ascending"><span class="hs-identifier">Ascending</span></a></a><span> </span><a href="#local-6989586621679348697"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">|</span><span> </span><a name="Descending"><a href="Database.Sql.Util.Eval.html#Descending"><span class="hs-identifier">Descending</span></a></a><span> </span><a href="#local-6989586621679348697"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-identifier hs-type">Eq</span><span>
</span><a name="line-308"></a><span>
</span><a name="line-309"></a><span class="hs-keyword">instance</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><a href="#local-6989586621679348811"><span class="hs-identifier hs-type">a</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-identifier hs-type">Ord</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#Direction"><span class="hs-identifier hs-type">Direction</span></a><span> </span><a href="#local-6989586621679348811"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-310"></a><span>    </span><a name="local-8214565720323792005"><span class="hs-identifier">compare</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#Descending"><span class="hs-identifier hs-var">Descending</span></a><span> </span><a name="local-6989586621679348812"><a href="#local-6989586621679348812"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#Descending"><span class="hs-identifier hs-var">Descending</span></a><span> </span><a name="local-6989586621679348813"><a href="#local-6989586621679348813"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679348813"><span class="hs-identifier hs-var">y</span></a><span> </span><a href="#local-6989586621679348812"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-311"></a><span>    </span><span class="hs-identifier">compare</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#Ascending"><span class="hs-identifier hs-var">Ascending</span></a><span> </span><a name="local-6989586621679348814"><a href="#local-6989586621679348814"><span class="hs-identifier">x</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#Ascending"><span class="hs-identifier hs-var">Ascending</span></a><span> </span><a name="local-6989586621679348815"><a href="#local-6989586621679348815"><span class="hs-identifier">y</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">compare</span><span> </span><a href="#local-6989586621679348814"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679348815"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-312"></a><span>    </span><span class="hs-identifier">compare</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;comparing ascending to descending - this shouldn't happen&quot;</span><span>
</span><a name="line-313"></a><span>
</span><a name="line-314"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679348807"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluate"><span class="hs-identifier hs-type">Evaluate</span></a><span> </span><a href="#local-6989586621679348807"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Limit"><span class="hs-identifier hs-type">Limit</span></a><span> </span><a href="#local-6989586621679348808"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-315"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalResult</span><span> </span><a href="#local-6989586621679348807"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Limit"><span class="hs-identifier hs-type">Limit</span></a><span> </span><a href="#local-6989586621679348808"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348807"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348807"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-316"></a><span>    </span><a name="local-8214565720324123583"><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><a name="local-6989586621679348809"><a href="#local-6989586621679348809"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Limit"><span class="hs-identifier hs-var">Limit</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348810"><a href="#local-6989586621679348810"><span class="hs-identifier">limit</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#limitItems"><span class="hs-identifier hs-var">limitItems</span></a><span> </span><a href="#local-6989586621679348809"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">read</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unpack</span><span> </span><a href="#local-6989586621679348810"><span class="hs-identifier hs-var">limit</span></a><span class="hs-special">)</span><span>
</span><a name="line-317"></a><span>
</span><a name="line-318"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679348803"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluate"><span class="hs-identifier hs-type">Evaluate</span></a><span> </span><a href="#local-6989586621679348803"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Offset"><span class="hs-identifier hs-type">Offset</span></a><span> </span><a href="#local-6989586621679348804"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-319"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalResult</span><span> </span><a href="#local-6989586621679348803"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Offset"><span class="hs-identifier hs-type">Offset</span></a><span> </span><a href="#local-6989586621679348804"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348803"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-type">RecordSet</span></a><span> </span><a href="#local-6989586621679348803"><span class="hs-identifier hs-type">e</span></a><span>
</span><a name="line-320"></a><span>    </span><a name="local-8214565720324123583"><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><a name="local-6989586621679348805"><a href="#local-6989586621679348805"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Offset"><span class="hs-identifier hs-var">Offset</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348806"><a href="#local-6989586621679348806"><span class="hs-identifier">offset</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#offsetItems"><span class="hs-identifier hs-var">offsetItems</span></a><span> </span><a href="#local-6989586621679348805"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">read</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">TL</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">unpack</span><span> </span><a href="#local-6989586621679348806"><span class="hs-identifier hs-var">offset</span></a><span class="hs-special">)</span><span>
</span><a name="line-321"></a><span>
</span><a name="line-322"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679348795"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluate"><span class="hs-identifier hs-type">Evaluate</span></a><span> </span><a href="#local-6989586621679348795"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Selection"><span class="hs-identifier hs-type">Selection</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-323"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalResult</span><span> </span><a href="#local-6989586621679348795"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Selection"><span class="hs-identifier hs-type">Selection</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348795"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348795"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348795"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">]</span><span>
</span><a name="line-324"></a><span>    </span><a name="local-8214565720324123583"><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><a name="local-6989586621679348796"><a href="#local-6989586621679348796"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectExpr"><span class="hs-identifier hs-var">SelectExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348797"><a href="#local-6989586621679348797"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348796"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348797"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-325"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348798"><a href="#local-6989586621679348798"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SelectStar"><span class="hs-identifier hs-var">SelectStar</span></a><span> </span><a name="local-6989586621679348799"><a href="#local-6989586621679348799"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Scope.html#StarColumnNames"><span class="hs-identifier hs-var">StarColumnNames</span></a><span> </span><a name="local-6989586621679348800"><a href="#local-6989586621679348800"><span class="hs-identifier">cols</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">forM</span><span> </span><a href="#local-6989586621679348800"><span class="hs-identifier hs-var">cols</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679348801"><a href="#local-6989586621679348801"><span class="hs-identifier">col</span></a></a><span class="hs-special">,</span><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><a name="line-326"></a><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-identifier">expr</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="Database.Sql.Type.Query.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span>
</span><a name="line-327"></a><span>            </span><a name="local-6989586621679348802"><a href="#local-6989586621679348802"><span class="hs-identifier">expr</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Type.Query.html#ColumnExpr"><span class="hs-identifier hs-var">ColumnExpr</span></a><span> </span><a href="#local-6989586621679348799"><span class="hs-identifier hs-var">info</span></a><span> </span><a href="#local-6989586621679348801"><span class="hs-identifier hs-var">col</span></a><span>
</span><a name="line-328"></a><span>         </span><span class="hs-keyword">in</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348798"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348802"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-329"></a><span>
</span><a name="line-330"></a><span>
</span><a name="line-331"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679348720"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluate"><span class="hs-identifier hs-type">Evaluate</span></a><span> </span><a href="#local-6989586621679348720"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-332"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalResult</span><span> </span><a href="#local-6989586621679348720"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Expr"><span class="hs-identifier hs-type">Expr</span></a><span> </span><a href="Database.Sql.Type.Scope.html#ResolvedNames"><span class="hs-identifier hs-type">ResolvedNames</span></a><span> </span><a href="Database.Sql.Position.html#Range"><span class="hs-identifier hs-type">Range</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348720"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348720"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348720"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-333"></a><span>    </span><a name="local-8214565720324123583"><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><a name="local-6989586621679348721"><a href="#local-6989586621679348721"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#BinOpExpr"><span class="hs-identifier hs-var">BinOpExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Operator"><span class="hs-identifier hs-var">Operator</span></a><span> </span><a name="local-6989586621679348722"><a href="#local-6989586621679348722"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679348723"><a href="#local-6989586621679348723"><span class="hs-identifier">lhs</span></a></a><span> </span><a name="local-6989586621679348724"><a href="#local-6989586621679348724"><span class="hs-identifier">rhs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-334"></a><span>        </span><a name="local-6989586621679348725"><a href="#local-6989586621679348725"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348721"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348723"><span class="hs-identifier hs-var">lhs</span></a><span>
</span><a name="line-335"></a><span>        </span><a name="local-6989586621679348726"><a href="#local-6989586621679348726"><span class="hs-identifier">y</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348721"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348724"><span class="hs-identifier hs-var">rhs</span></a><span>
</span><a name="line-336"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="Database.Sql.Util.Eval.html#binop"><span class="hs-identifier hs-var">binop</span></a><span> </span><a href="#local-6989586621679348721"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348722"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-337"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">throwError</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;unhandled operator: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679348722"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-338"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679348727"><a href="#local-6989586621679348727"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679348727"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679348725"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679348726"><span class="hs-identifier hs-var">y</span></a><span>
</span><a name="line-339"></a><span>
</span><a name="line-340"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348728"><a href="#local-6989586621679348728"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#CaseExpr"><span class="hs-identifier hs-var">CaseExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348729"><a href="#local-6989586621679348729"><span class="hs-identifier">cases</span></a></a><span> </span><a name="local-6989586621679348730"><a href="#local-6989586621679348730"><span class="hs-identifier">else_</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#handleCases"><span class="hs-identifier hs-var">handleCases</span></a><span> </span><a href="#local-6989586621679348728"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348729"><span class="hs-identifier hs-var">cases</span></a><span> </span><a href="#local-6989586621679348730"><span class="hs-identifier hs-var">else_</span></a><span>
</span><a name="line-341"></a><span>
</span><a name="line-342"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348731"><a href="#local-6989586621679348731"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#UnOpExpr"><span class="hs-identifier hs-var">UnOpExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Operator"><span class="hs-identifier hs-var">Operator</span></a><span> </span><a name="local-6989586621679348732"><a href="#local-6989586621679348732"><span class="hs-identifier">op</span></a></a><span class="hs-special">)</span><span> </span><a name="local-6989586621679348733"><a href="#local-6989586621679348733"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-343"></a><span>        </span><a name="local-6989586621679348734"><a href="#local-6989586621679348734"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348731"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348733"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-344"></a><span>        </span><span class="hs-keyword">case</span><span> </span><a href="Database.Sql.Util.Eval.html#unop"><span class="hs-identifier hs-var">unop</span></a><span> </span><a href="#local-6989586621679348731"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348732"><span class="hs-identifier hs-var">op</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-345"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">throwError</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;unhandled operator: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679348732"><span class="hs-identifier hs-var">op</span></a><span>
</span><a name="line-346"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679348735"><a href="#local-6989586621679348735"><span class="hs-identifier">f</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="#local-6989586621679348735"><span class="hs-identifier hs-var">f</span></a><span> </span><a href="#local-6989586621679348734"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-347"></a><span>
</span><a name="line-348"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348736"><a href="#local-6989586621679348736"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#LikeExpr"><span class="hs-identifier hs-var">LikeExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348737"><a href="#local-6989586621679348737"><span class="hs-identifier">op</span></a></a><span> </span><a name="local-6989586621679348738"><a href="#local-6989586621679348738"><span class="hs-identifier">escape</span></a></a><span> </span><a name="local-6989586621679348739"><a href="#local-6989586621679348739"><span class="hs-identifier">pattern</span></a></a><span> </span><a name="local-6989586621679348740"><a href="#local-6989586621679348740"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#handleLike"><span class="hs-identifier hs-var">handleLike</span></a><span> </span><a href="#local-6989586621679348736"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348737"><span class="hs-identifier hs-var">op</span></a><span> </span><a href="#local-6989586621679348738"><span class="hs-identifier hs-var">escape</span></a><span> </span><a href="#local-6989586621679348739"><span class="hs-identifier hs-var">pattern</span></a><span> </span><a href="#local-6989586621679348740"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-349"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348741"><a href="#local-6989586621679348741"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#ConstantExpr"><span class="hs-identifier hs-var">ConstantExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348742"><a href="#local-6989586621679348742"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348741"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348742"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-350"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#ColumnExpr"><span class="hs-identifier hs-var">ColumnExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348743"><a href="#local-6989586621679348743"><span class="hs-identifier">col</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-351"></a><span>        </span><a name="local-6989586621679348744"><a href="#local-6989586621679348744"><span class="hs-identifier">row</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">asks</span><span> </span><span class="hs-identifier">evalRow</span><span>
</span><a name="line-352"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">void</span><span> </span><a href="#local-6989586621679348743"><span class="hs-identifier hs-var">col</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348744"><span class="hs-identifier hs-var">row</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-353"></a><span>            </span><span class="hs-identifier hs-var">Just</span><span> </span><a name="local-6989586621679348745"><a href="#local-6989586621679348745"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">pure</span><span> </span><a href="#local-6989586621679348745"><span class="hs-identifier hs-var">x</span></a><span>
</span><a name="line-354"></a><span>            </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">throwError</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-string">&quot;failure looking up column: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">void</span><span> </span><a href="#local-6989586621679348743"><span class="hs-identifier hs-var">col</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; in &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">M</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">keys</span><span> </span><a href="#local-6989586621679348744"><span class="hs-identifier hs-var">row</span></a><span class="hs-special">)</span><span>
</span><a name="line-355"></a><span>
</span><a name="line-356"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348746"><a href="#local-6989586621679348746"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#InListExpr"><span class="hs-identifier hs-var">InListExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348747"><a href="#local-6989586621679348747"><span class="hs-identifier">list</span></a></a><span> </span><a name="local-6989586621679348748"><a href="#local-6989586621679348748"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-357"></a><span>        </span><a name="local-6989586621679348749"><a href="#local-6989586621679348749"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348746"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348748"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-358"></a><span>        </span><a name="local-6989586621679348750"><a href="#local-6989586621679348750"><span class="hs-identifier">xs</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348746"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348747"><span class="hs-identifier hs-var">list</span></a><span>
</span><a name="line-359"></a><span>        </span><a href="Database.Sql.Util.Eval.html#inList"><span class="hs-identifier hs-var">inList</span></a><span> </span><a href="#local-6989586621679348749"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679348750"><span class="hs-identifier hs-var">xs</span></a><span>
</span><a name="line-360"></a><span>
</span><a name="line-361"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348751"><a href="#local-6989586621679348751"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#InSubqueryExpr"><span class="hs-identifier hs-var">InSubqueryExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348752"><a href="#local-6989586621679348752"><span class="hs-identifier">query</span></a></a><span> </span><a name="local-6989586621679348753"><a href="#local-6989586621679348753"><span class="hs-identifier">expr</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-362"></a><span>        </span><a name="local-6989586621679348754"><a href="#local-6989586621679348754"><span class="hs-identifier">x</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348751"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348753"><span class="hs-identifier hs-var">expr</span></a><span>
</span><a name="line-363"></a><span>        </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#tableToExpr"><span class="hs-identifier hs-var">tableToExpr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348751"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348752"><span class="hs-identifier hs-var">query</span></a><span>
</span><a name="line-364"></a><span>        </span><span class="hs-keyword">case</span><span> </span><span class="hs-identifier hs-var">length</span><span> </span><a href="#local-6989586621679348755"><span class="hs-identifier hs-var">recordSetLabels</span></a><span> </span><span class="hs-keyword">of</span><span>
</span><a name="line-365"></a><span>         </span><span class="hs-number">1</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#inSubquery"><span class="hs-identifier hs-var">inSubquery</span></a><span> </span><a href="#local-6989586621679348754"><span class="hs-identifier hs-var">x</span></a><span> </span><a href="#local-6989586621679348756"><span class="hs-identifier hs-var">recordSetItems</span></a><span>
</span><a name="line-366"></a><span>         </span><span class="hs-number">0</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">throwError</span><span> </span><span class="hs-string">&quot;no columns returned from subquery for IN&quot;</span><span>
</span><a name="line-367"></a><span>         </span><span class="hs-identifier">_</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-var">throwError</span><span> </span><span class="hs-string">&quot;multiple columns returned from subquery for IN&quot;</span><span>
</span><a name="line-368"></a><span>
</span><a name="line-369"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348757"><a href="#local-6989586621679348757"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#BetweenExpr"><span class="hs-identifier hs-var">BetweenExpr</span></a><span> </span><a name="local-6989586621679348758"><a href="#local-6989586621679348758"><span class="hs-identifier">info</span></a></a><span> </span><a name="local-6989586621679348759"><a href="#local-6989586621679348759"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679348760"><a href="#local-6989586621679348760"><span class="hs-identifier">start</span></a></a><span> </span><a name="local-6989586621679348761"><a href="#local-6989586621679348761"><span class="hs-identifier">end</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348757"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Type.Query.html#BinOpExpr"><span class="hs-identifier hs-var">BinOpExpr</span></a><span> </span><a href="#local-6989586621679348758"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Operator"><span class="hs-identifier hs-var">Operator</span></a><span> </span><span class="hs-string">&quot;AND&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-370"></a><span>        </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#BinOpExpr"><span class="hs-identifier hs-var">BinOpExpr</span></a><span> </span><a href="#local-6989586621679348758"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Operator"><span class="hs-identifier hs-var">Operator</span></a><span> </span><span class="hs-string">&quot;&lt;=&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348760"><span class="hs-identifier hs-var">start</span></a><span> </span><a href="#local-6989586621679348759"><span class="hs-identifier hs-var">expr</span></a><span class="hs-special">)</span><span>
</span><a name="line-371"></a><span>        </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#BinOpExpr"><span class="hs-identifier hs-var">BinOpExpr</span></a><span> </span><a href="#local-6989586621679348758"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Operator"><span class="hs-identifier hs-var">Operator</span></a><span> </span><span class="hs-string">&quot;&lt;=&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348759"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679348761"><span class="hs-identifier hs-var">end</span></a><span class="hs-special">)</span><span>
</span><a name="line-372"></a><span>
</span><a name="line-373"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348762"><a href="#local-6989586621679348762"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#OverlapsExpr"><span class="hs-identifier hs-var">OverlapsExpr</span></a><span> </span><a name="local-6989586621679348763"><a href="#local-6989586621679348763"><span class="hs-identifier">info</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679348764"><a href="#local-6989586621679348764"><span class="hs-identifier">lstart</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679348765"><a href="#local-6989586621679348765"><span class="hs-identifier">lend</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a name="local-6989586621679348766"><a href="#local-6989586621679348766"><span class="hs-identifier">rstart</span></a></a><span class="hs-special">,</span><span> </span><a name="local-6989586621679348767"><a href="#local-6989586621679348767"><span class="hs-identifier">rend</span></a></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348762"><span class="hs-identifier hs-var">p</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Type.Query.html#BinOpExpr"><span class="hs-identifier hs-var">BinOpExpr</span></a><span> </span><a href="#local-6989586621679348763"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Operator"><span class="hs-identifier hs-var">Operator</span></a><span> </span><span class="hs-string">&quot;AND&quot;</span><span class="hs-special">)</span><span>
</span><a name="line-374"></a><span>        </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#BinOpExpr"><span class="hs-identifier hs-var">BinOpExpr</span></a><span> </span><a href="#local-6989586621679348763"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Operator"><span class="hs-identifier hs-var">Operator</span></a><span> </span><span class="hs-string">&quot;&lt;&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348764"><span class="hs-identifier hs-var">lstart</span></a><span> </span><a href="#local-6989586621679348767"><span class="hs-identifier hs-var">rend</span></a><span class="hs-special">)</span><span>
</span><a name="line-375"></a><span>        </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#BinOpExpr"><span class="hs-identifier hs-var">BinOpExpr</span></a><span> </span><a href="#local-6989586621679348763"><span class="hs-identifier hs-var">info</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Operator"><span class="hs-identifier hs-var">Operator</span></a><span> </span><span class="hs-string">&quot;&lt;&quot;</span><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348766"><span class="hs-identifier hs-var">rstart</span></a><span> </span><a href="#local-6989586621679348765"><span class="hs-identifier hs-var">lend</span></a><span class="hs-special">)</span><span>
</span><a name="line-376"></a><span>
</span><a name="line-377"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348768"><a href="#local-6989586621679348768"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#FunctionExpr"><span class="hs-identifier hs-var">FunctionExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348769"><a href="#local-6989586621679348769"><span class="hs-identifier">fn</span></a></a><span> </span><a name="local-6989586621679348770"><a href="#local-6989586621679348770"><span class="hs-identifier">isDistinct</span></a></a><span> </span><a name="local-6989586621679348771"><a href="#local-6989586621679348771"><span class="hs-identifier">args</span></a></a><span> </span><a name="local-6989586621679348772"><a href="#local-6989586621679348772"><span class="hs-identifier">parms</span></a></a><span> </span><a name="local-6989586621679348773"><a href="#local-6989586621679348773"><span class="hs-identifier">filter'</span></a></a><span> </span><a name="local-6989586621679348774"><a href="#local-6989586621679348774"><span class="hs-identifier">over</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#handleFunction"><span class="hs-identifier hs-var">handleFunction</span></a><span> </span><a href="#local-6989586621679348768"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348769"><span class="hs-identifier hs-var">fn</span></a><span> </span><a href="#local-6989586621679348770"><span class="hs-identifier hs-var">isDistinct</span></a><span> </span><a href="#local-6989586621679348771"><span class="hs-identifier hs-var">args</span></a><span> </span><a href="#local-6989586621679348772"><span class="hs-identifier hs-var">parms</span></a><span> </span><a href="#local-6989586621679348773"><span class="hs-identifier hs-var">filter'</span></a><span> </span><a href="#local-6989586621679348774"><span class="hs-identifier hs-var">over</span></a><span>
</span><a name="line-378"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348775"><a href="#local-6989586621679348775"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#AtTimeZoneExpr"><span class="hs-identifier hs-var">AtTimeZoneExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348776"><a href="#local-6989586621679348776"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679348777"><a href="#local-6989586621679348777"><span class="hs-identifier">tz</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">join</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#atTimeZone"><span class="hs-identifier hs-var">atTimeZone</span></a><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348775"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348776"><span class="hs-identifier hs-var">expr</span></a><span> </span><span class="hs-operator hs-var">&lt;*&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348775"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348777"><span class="hs-identifier hs-var">tz</span></a><span>
</span><a name="line-379"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348778"><a href="#local-6989586621679348778"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#SubqueryExpr"><span class="hs-identifier hs-var">SubqueryExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348779"><a href="#local-6989586621679348779"><span class="hs-identifier">query</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-380"></a><span>        </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#tableToExpr"><span class="hs-identifier hs-var">tableToExpr</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348778"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348779"><span class="hs-identifier hs-var">query</span></a><span>
</span><a name="line-381"></a><span>        </span><a href="Database.Sql.Util.Eval.html#handleSubquery"><span class="hs-identifier hs-var">handleSubquery</span></a><span> </span><a href="#local-6989586621679348781"><span class="hs-identifier hs-var">recordSetItems</span></a><span>
</span><a name="line-382"></a><span>
</span><a name="line-383"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348782"><a href="#local-6989586621679348782"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#ArrayExpr"><span class="hs-identifier hs-var">ArrayExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348783"><a href="#local-6989586621679348783"><span class="hs-identifier">exprs</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;array expression not yet supported&quot;</span><span> </span><span class="hs-operator hs-var">&lt;$&gt;</span><span> </span><span class="hs-identifier hs-var">mapM</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348782"><span class="hs-identifier hs-var">p</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679348783"><span class="hs-identifier hs-var">exprs</span></a><span> </span><span class="hs-comment">-- T636472</span><span>
</span><a name="line-384"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><a name="local-6989586621679348784"><a href="#local-6989586621679348784"><span class="hs-identifier">p</span></a></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#ExistsExpr"><span class="hs-identifier hs-var">ExistsExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348785"><a href="#local-6989586621679348785"><span class="hs-identifier">query</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-385"></a><span>        </span><a href="Database.Sql.Util.Eval.html#RecordSet"><span class="hs-identifier hs-var">RecordSet</span></a><span class="hs-special">{</span><span class="hs-glyph">..</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><a href="Database.Sql.Util.Eval.html#tableToExpr"><span class="hs-identifier hs-var">tableToExpr</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier hs-var">eval</span></a><span> </span><a href="#local-6989586621679348784"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348785"><span class="hs-identifier hs-var">query</span></a><span class="hs-special">)</span><span>
</span><a name="line-386"></a><span>        </span><a href="Database.Sql.Util.Eval.html#existsSubquery"><span class="hs-identifier hs-var">existsSubquery</span></a><span> </span><a href="#local-6989586621679348787"><span class="hs-identifier hs-var">recordSetItems</span></a><span>
</span><a name="line-387"></a><span>
</span><a name="line-388"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#FieldAccessExpr"><span class="hs-identifier hs-var">FieldAccessExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348788"><a href="#local-6989586621679348788"><span class="hs-identifier">struct</span></a></a><span> </span><a name="local-6989586621679348789"><a href="#local-6989586621679348789"><span class="hs-identifier">field</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#handleStructField"><span class="hs-identifier hs-var">handleStructField</span></a><span> </span><a href="#local-6989586621679348788"><span class="hs-identifier hs-var">struct</span></a><span> </span><a href="#local-6989586621679348789"><span class="hs-identifier hs-var">field</span></a><span>
</span><a name="line-389"></a><span>
</span><a name="line-390"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#ArrayAccessExpr"><span class="hs-identifier hs-var">ArrayAccessExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348790"><a href="#local-6989586621679348790"><span class="hs-identifier">array</span></a></a><span> </span><a name="local-6989586621679348791"><a href="#local-6989586621679348791"><span class="hs-identifier">idx</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">error</span><span> </span><span class="hs-string">&quot;array indexing not yet supported&quot;</span><span> </span><a href="#local-6989586621679348790"><span class="hs-identifier hs-var">array</span></a><span> </span><a href="#local-6989586621679348791"><span class="hs-identifier hs-var">idx</span></a><span> </span><span class="hs-comment">-- T636558</span><span>
</span><a name="line-391"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#TypeCastExpr"><span class="hs-identifier hs-var">TypeCastExpr</span></a><span> </span><span class="hs-identifier">_</span><span> </span><a name="local-6989586621679348792"><a href="#local-6989586621679348792"><span class="hs-identifier">onFail</span></a></a><span> </span><a name="local-6989586621679348793"><a href="#local-6989586621679348793"><span class="hs-identifier">expr</span></a></a><span> </span><a name="local-6989586621679348794"><a href="#local-6989586621679348794"><span class="hs-identifier">type_</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#handleTypeCast"><span class="hs-identifier hs-var">handleTypeCast</span></a><span> </span><a href="#local-6989586621679348792"><span class="hs-identifier hs-var">onFail</span></a><span> </span><a href="#local-6989586621679348793"><span class="hs-identifier hs-var">expr</span></a><span> </span><a href="#local-6989586621679348794"><span class="hs-identifier hs-var">type_</span></a><span>
</span><a name="line-392"></a><span>    </span><span class="hs-identifier">eval</span><span> </span><span class="hs-identifier">_</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#VariableSubstitutionExpr"><span class="hs-identifier hs-var">VariableSubstitutionExpr</span></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">throwError</span><span> </span><span class="hs-string">&quot;no way to evaluate unsubstituted variable&quot;</span><span>
</span><a name="line-393"></a><span>
</span><a name="line-394"></a><span class="hs-keyword">instance</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluation"><span class="hs-identifier hs-type">Evaluation</span></a><span> </span><a href="#local-6989586621679348716"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-glyph">=&gt;</span><span> </span><a href="Database.Sql.Util.Eval.html#Evaluate"><span class="hs-identifier hs-type">Evaluate</span></a><span> </span><a href="#local-6989586621679348716"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Constant"><span class="hs-identifier hs-type">Constant</span></a><span> </span><a href="#local-6989586621679348717"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><a name="line-395"></a><span>    </span><span class="hs-keyword">type</span><span> </span><span class="hs-identifier">EvalResult</span><span> </span><a href="#local-6989586621679348716"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Type.Query.html#Constant"><span class="hs-identifier hs-type">Constant</span></a><span> </span><a href="#local-6989586621679348717"><span class="hs-identifier hs-type">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#EvalT"><span class="hs-identifier hs-type">EvalT</span></a><span> </span><a href="#local-6989586621679348716"><span class="hs-identifier hs-type">e</span></a><span> </span><span class="hs-special">'</span><a href="Database.Sql.Util.Eval.html#ExprContext"><span class="hs-identifier hs-type">ExprContext</span></a><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalMonad"><span class="hs-identifier hs-type">EvalMonad</span></a><span> </span><a href="#local-6989586621679348716"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Database.Sql.Util.Eval.html#EvalValue"><span class="hs-identifier hs-type">EvalValue</span></a><span> </span><a href="#local-6989586621679348716"><span class="hs-identifier hs-type">e</span></a><span class="hs-special">)</span><span>
</span><a name="line-396"></a><span>    </span><a name="local-8214565720324123583"><a href="Database.Sql.Util.Eval.html#eval"><span class="hs-identifier">eval</span></a></a><span> </span><a name="local-6989586621679348718"><a href="#local-6989586621679348718"><span class="hs-identifier">p</span></a></a><span> </span><a name="local-6989586621679348719"><a href="#local-6989586621679348719"><span class="hs-identifier">constant</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Database.Sql.Util.Eval.html#handleConstant"><span class="hs-identifier hs-var">handleConstant</span></a><span> </span><a href="#local-6989586621679348718"><span class="hs-identifier hs-var">p</span></a><span> </span><a href="#local-6989586621679348719"><span class="hs-identifier hs-var">constant</span></a><span>
</span><a name="line-397"></a></pre></body></html>